!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react-dom"),require("react"),require("jszip")):"function"==typeof define&&define.amd?define(["exports","react-dom","react","jszip"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).WebApp={},e.ReactDOM,e.React,e.JSZip)}(this,(function(e,t,n,r){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}function a(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}var s=o(t),l=i(r);function c(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x60;/g,"`")}function h(e,t,n={}){var r,i,o,a,s=0,l=function(){s=!1===n.leading?0:Date.now(),r=null,a=e.apply(i,o),r||(i=o=null)};return function(){var c=Date.now();s||!1!==n.leading||(s=c);var h=t-(c-s);return i=this,o=arguments,h<=0||h>t?(r&&(clearTimeout(r),r=null),s=c,a=e.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(l,h)),a}}function d(e,t,n=!1){var r,i;function o(t,n){r=null,n&&(i=e.apply(t,n))}return function(...a){if(r&&clearTimeout(r),n){var s=!r;r=setTimeout(o,t),s&&(i=e.apply(this,a))}else r=function(e,t,...n){return setTimeout((()=>e.apply(null,n)),t)}(o,t,this,a);return i}}function u(e,t){return{x:e.x-t.x,y:e.y-t.y}}class f{constructor(e,t){this.onChange=t,this.offset={x:0,y:0},this.zoomLevel=0,this.superSampling=window.devicePixelRatio||1;var n=!1;var r=()=>{n=!1,e.style.width="33%"};e.addEventListener("mousedown",(t=>{e.style.width="100%",n=u({x:t.pageX,y:t.pageY},this.offset)})),e.addEventListener("mouseup",r),e.addEventListener("mouseleave",r),e.addEventListener("wheel",h((e=>{this.zoomLevel=Math.min(10,this.zoomLevel-(e.deltaY<0?-1:1)),t()}),50),{passive:!0}),e.addEventListener("mousemove",h((e=>{0!=n&&(this.offset=u({x:e.pageX,y:e.pageY},n),t())}),50),{passive:!0})}positionCanvas(e){var t=window,n=e.width/this.superSampling,r=e.height/this.superSampling;e.style.top=300*(1-r/t.innerHeight)+this.offset.y+"px",e.style.left=150+(t.innerWidth-n)/2+this.offset.x+"px",e.style.width=n+"px",e.style.height=r+"px"}zoom(){return this.superSampling*Math.exp(this.zoomLevel/10)}magnify(e){this.zoomLevel=Math.min(10,this.zoomLevel+e),this.onChange()}reset(){this.zoomLevel=1,this.offset={x:0,y:0},this.onChange()}}class v{constructor(e,t,n){this.editor=e,this.marker=t,this.lineNumbers=n}clearState(){this.marker.style.top="-30px",this.lineNumbers.classList.remove("error")}setError(e){this.lineNumbers.classList.add("error");var t=e.message.match("line ([0-9]*)");if(!t)throw e;var n=window.getComputedStyle(this.editor).lineHeight,r=parseFloat(n)||12;this.marker.style.top=3+r*+t[1]+"px"}}var p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function g(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function m(e){var t=e.default;if("function"==typeof t){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var y={exports:{}};!function(e,t){!function(){function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){s(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof p&&p.global===p?p:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(e,t,a){var s=o.URL||o.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):r(l.href)?n(e,t,a):i(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,o,a){if(o=o||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,a),o);else if(r(e))n(e,o,a);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){i(s)}))}}:function(e,t,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,r);var s="application/octet-stream"===e.type,l=/constructor/i.test(o.HTMLElement)||o.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||a)&&"undefined"!=typeof FileReader){var h=new FileReader;h.onloadend=function(){var e=h.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},h.readAsDataURL(e)}else{var d=o.URL||o.webkitURL,u=d.createObjectURL(e);i?i.location=u:location.href=u,i=null,setTimeout((function(){d.revokeObjectURL(u)}),4e4)}});o.saveAs=s.saveAs=s,e.exports=s}()}(y);var w,x,b=y.exports,_={exports:{}},k={exports:{}},E={exports:{}};function S(){return w||(w=1,function(e,t){!function(e){class t{constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,t=e._prev;if(t!==e)return n(t),t}enqueue(e){var t=this._sentinel,r=e;r._prev&&r._next&&n(r),r._next=t._next,t._next._prev=r,t._next=r,r._prev=t}toString(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,r)),n=n._prev;return"["+e.join(", ")+"]"}}function n(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function r(e,t){if("_next"!==e&&"_prev"!==e)return t}var i=Object.freeze({__proto__:null,List:t});const o={};function a(e){var t=[];for(var n of e)t.push(...n);return t}function s(e,t){return null!=e&&e.hasOwnProperty(t)}function l(e){const t=null==e?0:e.length;return t?e[t-1]:void 0}function c(e,t){e=Object(e);const n={};return Object.keys(e).forEach((r=>{n[r]=t(e[r],r)})),n}function h(e,t){var n=Number.POSITIVE_INFINITY,r=void 0;for(var i of e){var o=t(i);o<n&&(n=o,r=i)}return r}function d(e,t){var n=e<t?1:-1;let r=-1,i=Math.max(Math.ceil((t-e)/(n||1)),0);const o=new Array(i);for(;i--;)o[++r]=e,e+=n;return o}function u(e,t){return e.slice().sort(((e,n)=>t(e)-t(n)))}function f(e){return o[e]||(o[e]=0),`${e}${++o[e]}`}function v(e){return e?Object.keys(e).map((t=>e[t])):[]}function p(e,t){for(var n=[],r=0;r<e;r++)n.push(t());return n}function g(e){return void 0===e}function m(e,t){for(var n of Object.keys(e))t(e[n],n)}function y(e){return 0===Object.keys(e).length}function w(e){var t={},n=e.nodes().filter((t=>!e.children(t).length)),r=p(Math.max(...n.map((t=>e.node(t).rank)))+1,(()=>[]));return u(n,(t=>e.node(t).rank)).forEach((function n(i){if(!s(t,i)){t[i]=!0;var o=e.node(i);r[o.rank].push(i),e.successors(i).forEach(n)}})),r}function x(e,t){for(var n=0,r=1;r<t.length;++r)n+=b(e,t[r-1],t[r]);return n}function b(e,t,n){for(var r={},i=0;i<n.length;i++)r[n[i]]=i;for(var o=a(t.map((function(t){return u(e.outEdges(t).map((function(t){return{pos:r[t.w],weight:e.edge(t).weight}})),(e=>e.pos))}))),s=1;s<n.length;)s<<=1;var l=2*s-1;s-=1;var c=p(l,(()=>0)),h=0;return o.forEach((function(e){var t=e.pos+s;c[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=c[t+1]),c[t=t-1>>1]+=e.weight;h+=e.weight*n})),h}function _(e,t){return t?t.map((function(t){var n=e.inEdges(t);if(n.length){var r=n.reduce((function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}}),{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}return{v:t}})):[]}function k(e,t){for(var n={},r=0;r<e.length;r++){var i=e[r],o=n[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:r};void 0!==i.barycenter&&(o.barycenter=i.barycenter,o.weight=i.weight)}for(var a of t.edges()){var s=n[a.v],l=n[a.w];void 0!==s&&void 0!==l&&(l.indegree++,s.out.push(n[a.w]))}return function(e){var t=[];function n(e){return function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&function(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function r(t){return function(n){n.in.push(t),0==--n.indegree&&e.push(n)}}for(;e.length;){var i=e.pop();t.push(i),i.in.reverse().forEach(n(i)),i.out.forEach(r(i))}return t.filter((e=>!e.merged)).map((function(e){var t={vs:e.vs,i:e.i};return"barycenter"in e&&(t.barycenter=e.barycenter),"weight"in e&&(t.weight=e.weight),t}))}(v(n).filter((e=>!e.indegree)))}var E="\0";class S{constructor(e={}){this._label=void 0,this._nodeCount=0,this._edgeCount=0,this._isDirected=!s(e,"directed")||e.directed,this._isMultigraph=!!s(e,"multigraph")&&e.multigraph,this._isCompound=!!s(e,"compound")&&e.compound,this._defaultNodeLabelFn=()=>{},this._defaultEdgeLabelFn=()=>{},this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){var t;return t=e,this._defaultNodeLabelFn="function"!=typeof t?()=>e:e,this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var e=this;return this.nodes().filter((function(t){return y(e._in[t])}))}sinks(){var e=this;return this.nodes().filter((t=>y(e._out[t])))}setNodes(e,t){for(var n of e)void 0!==t?this.setNode(n,t):this.setNode(n);return this}setNode(e,t){return s(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=E,this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}node(e){return this._nodes[e]}hasNode(e){return s(this._nodes,e)}removeNode(e){var t=this;if(s(this._nodes,e)){var n=e=>{t.removeEdge(this._edgeObjs[e])};if(delete this._nodes[e],this._isCompound){for(var r of(this._removeFromParentsChildList(e),delete this._parent[e],this.children(e)))t.setParent(r);delete this._children[e]}for(var i of Object.keys(this._in[e]))n(i);for(var i of(delete this._in[e],delete this._preds[e],Object.keys(this._out[e])))n(i);delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(void 0===t)t=E;else{for(var n=t+="";!g(n);n=this.parent(n))if(n===e)throw new Error(`Setting ${t} as parent of ${e} would create a cycle`);this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var t=this._parent[e];if(t!==E)return t}}children(e){if(g(e)&&(e=E),this._isCompound){var t=this._children[e];return t?Object.keys(t):void 0}return e===E?this.nodes():this.hasNode(e)?[]:void 0}predecessors(e){var t=this._preds[e];if(t)return Object.keys(t)}successors(e){var t=this._sucs[e];if(t)return Object.keys(t)}neighbors(e){var t=this.predecessors(e);if(t)return function(e,t){var n=[...e];for(var r of t)-1===n.indexOf(r)&&n.push(r);return n}(t,this.successors(e))}isLeaf(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length}filterNodes(e){var t=new S({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;m(this._nodes,(function(n,r){e(r)&&t.setNode(r,n)})),m(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))}));var r={};function i(e){var o=n.parent(e);return void 0===o||t.hasNode(o)?(r[e]=o,o):o in r?r[o]:i(o)}if(this._isCompound)for(var o of t.nodes())t.setParent(o,i(o));return t}setDefaultEdgeLabel(e){var t;return t=e,this._defaultEdgeLabelFn="function"!=typeof t?()=>e:e,this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(e,t){var n=this,r=arguments;return e.reduce((function(e,i){return r.length>1?n.setEdge(e,i,t):n.setEdge(e,i),i})),this}setEdge(e,t,n,r){var i=!1,o=e;"object"==typeof o&&null!==o&&"v"in o?(e=o.v,t=o.w,r=o.name,2===arguments.length&&(n=arguments[1],i=!0)):(e=o,t=arguments[1],r=arguments[3],arguments.length>2&&(n=arguments[2],i=!0)),e=""+e,t=""+t,g(r)||(r=""+r);var a=L(this._isDirected,e,t,r);if(s(this._edgeLabels,a))return i&&(this._edgeLabels[a]=n),this;if(!g(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[a]=i?n:this._defaultEdgeLabelFn(e,t,r);var l=function(e,t,n,r){var i=""+t,o=""+n;if(!e&&i>o){var a=i;i=o,o=a}var s={v:i,w:o};return r&&(s.name=r),s}(this._isDirected,e,t,r);return e=l.v,t=l.w,Object.freeze(l),this._edgeObjs[a]=l,N(this._preds[t],e),N(this._sucs[e],t),this._in[t][a]=l,this._out[e][a]=l,this._edgeCount++,this}edge(e,t,n){var r="object"==typeof e?T(this._isDirected,e):L(this._isDirected,e,t,n);return this._edgeLabels[r]}hasEdge(e,t,n){var r=1===arguments.length?T(this._isDirected,arguments[0]):L(this._isDirected,e,t,n);return s(this._edgeLabels,r)}removeEdge(e,t,n){var r="object"==typeof e?T(this._isDirected,e):L(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],z(this._preds[t],e),z(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this}inEdges(e,t){var n=this._in[e];if(n){var r=Object.values(n);return t?r.filter((function(e){return e.v===t})):r}}outEdges(e,t){var n=this._out[e];if(n){var r=Object.values(n);return t?r.filter((function(e){return e.w===t})):r}}nodeEdges(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}}class M extends S{}function N(e,t){e[t]?e[t]++:e[t]=1}function z(e,t){--e[t]||delete e[t]}function L(e,t,n,r){var i=""+t,o=""+n;if(!e&&i>o){var a=i;i=o,o=a}return i+""+o+""+(g(r)?"\0":r)}function T(e,t){return L(e,t.v,t.w,t.name)}function I(e,t,n,r){var i;do{i=f(r)}while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function C(e){var t=(new S).setGraph(e.graph());for(var n of e.nodes())t.setNode(n,e.node(n));for(var r of e.edges()){var i=t.edge(r.v,r.w)||{weight:0,minlen:1},o=e.edge(r);t.setEdge(r.v,r.w,{weight:i.weight+o.weight,minlen:Math.max(i.minlen,o.minlen)})}return t}function O(e){var t=new S({multigraph:e.isMultigraph()}).setGraph(e.graph());for(var n of e.nodes())e.children(n).length||t.setNode(n,e.node(n));for(var r of e.edges())t.setEdge(r,e.edge(r));return t}function j(e,t){var n,r,i=e.x,o=e.y,a=t.x-i,s=t.y-o,l=e.width/2,c=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*l>Math.abs(a)*c?(s<0&&(c=-c),n=c*a/s,r=c):(a<0&&(l=-l),n=l,r=l*s/a),{x:i+n,y:o+r}}function A(e){var t=p(F(e)+1,(()=>[]));for(var n of e.nodes()){var r=e.node(n),i=r.rank;void 0!==i&&(t[i][r.order]=n)}return t}function P(e){var t=Math.min(...e.nodes().map((t=>e.node(t).rank)).filter((e=>void 0!==e)));for(var n of e.nodes()){var r=e.node(n);s(r,"rank")&&(r.rank-=t)}}function R(e){var t=Math.min(...e.nodes().map((t=>e.node(t).rank)).filter((e=>void 0!==e))),n=[];for(var r of e.nodes()){var i=e.node(r).rank-t;n[i]||(n[i]=[]),n[i].push(r)}for(var o=0,a=e.graph().nodeRankFactor,s=0;s<n.length;s++){var l=n[s];if(void 0===l&&s%a!=0)--o;else if(o&&null!=l)for(var r of l)e.node(r).rank+=o}}function D(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),I(e,"border",i,t)}function F(e){var t=e.nodes().map((t=>e.node(t).rank)).filter((e=>void 0!==e));return Math.max(...t)}function B(e,t){var n=[],r=[];for(var i of e)t(i)?n.push(i):r.push(i);return{lhs:n,rhs:r}}function $(e,t){var n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}}function q(e,t){return t()}var V=Object.freeze({__proto__:null,addDummyNode:I,simplify:C,asNonCompoundGraph:O,successorWeights:function(e){var t={};for(var n of e.nodes()){var r={};for(var i of e.outEdges(n))r[i.w]=(r[i.w]||0)+e.edge(i).weight;t[n]=r}return t},predecessorWeights:function(e){var t={};for(var n of e.nodes()){var r={};for(var i of e.inEdges(n))r[i.v]=(r[i.v]||0)+e.edge(i).weight;t[n]=r}return t},intersectRect:j,buildLayerMatrix:A,normalizeRanks:P,removeEmptyRanks:R,addBorderNode:D,maxRank:F,partition:B,time:$,notime:q});function G(e,t){var n,r=B(e,(function(e){return s(e,"barycenter")})),i=r.lhs,o=u(r.rhs,(e=>-e.i)),l=[],c=0,h=0,d=0;for(var f of(i.sort((n=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:n?t.i-e.i:e.i-t.i})),d=W(l,o,d),i))d+=f.vs.length,l.push(f.vs),c+=f.barycenter*f.weight,h+=f.weight,d=W(l,o,d);var v={vs:a(l)};return h&&(v.barycenter=c/h,v.weight=h),v}function W(e,t,n){for(var r;t.length&&(r=l(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function H(e,t,n,r){var i=e.children(t),o=e.node(t),l=o?o.borderLeft:void 0,c=o?o.borderRight:void 0,h={};l&&(i=i.filter((e=>e!==l&&e!==c)));var d=_(e,i);for(var u of d)if(e.children(u.v).length){var f=H(e,u.v,n,r);h[u.v]=f,s(f,"barycenter")&&U(u,f)}var v=k(d,n);!function(e,t){for(var n of e)n.vs=a(n.vs.map((function(e){return t[e]?t[e].vs:[e]})))}(v,h);var p=G(v,r);if(l&&(p.vs=[l,...p.vs,c],e.predecessors(l).length)){var g=e.node(e.predecessors(l)[0]),m=e.node(e.predecessors(c)[0]);s(p,"barycenter")||(p.barycenter=0,p.weight=0),p.barycenter=(p.barycenter*p.weight+g.order+m.order)/(p.weight+2),p.weight+=2}return p}function U(e,t){void 0!==e.barycenter?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)}function Y(e,t,n){var r=function(e){for(var t;e.hasNode(t=f("_root")););return t}(e),i=new S({compound:!0}).setGraph({root:r}).setDefaultNodeLabel((t=>e.node(t)));for(var o of e.nodes()){var a=e.node(o),l=e.parent(o);if(a.rank===t||a.minRank<=t&&t<=a.maxRank){for(var c of(i.setNode(o),i.setParent(o,l||r),e[n](o))){var h=c.v===o?c.w:c.v,d=i.edge(h,o),u=void 0!==d?d.weight:0;i.setEdge(h,o,{weight:e.edge(c).weight+u})}s(a,"minRank")&&i.setNode(o,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]})}}return i}function J(e,t,n){var r,i={};for(var o of n)!function(){for(var n,a=e.parent(o);a;){var s=e.parent(a);if(s?(n=i[s],i[s]=a):(n=r,r=a),n&&n!==a)return void t.setEdge(n,a);a=s}}()}function K(e){var t=F(e),n=Q(e,d(1,t+1),"inEdges"),r=Q(e,d(t-1,-1),"outEdges"),i=w(e);Z(e,i);for(var o,a=Number.POSITIVE_INFINITY,s=0,l=0;l<4;++s,++l){X(s%2?n:r,s%4>=2);var c=x(e,i=A(e));c<a&&(l=0,o=i.map((e=>e.slice(0))),a=c)}Z(e,o)}function Q(e,t,n){return t.map((t=>Y(e,t,n)))}function X(e,t){var n=new S;for(var r of e){var i=r.graph().root,o=H(r,i,n,t);o.vs.map((function(e,t){r.node(e).order=t})),J(r,n,o.vs)}}function Z(e,t){for(var n of t)n.map((function(t,n){e.node(t).order=n}))}var ee=Object.freeze({__proto__:null,order:K,addSubgraphConstraints:J,barycenter:_,buildLayerGraph:Y,crossCount:x,initOrder:w,resolveConflicts:k,sortSubgraph:H,sort:G});function te(e,t){var n={};return t.reduce((function(t,r){for(var i=0,o=0,a=t.length,s=l(r),c=0;c<r.length;c++){var h=r[c],d=re(e,h),u=d?e.node(d).order:a;if(d||h===s){for(var f of r.slice(o,c+1))for(var v of e.predecessors(f)){var p=e.node(v),g=p.order;!(g<i||u<g)||p.dummy&&e.node(f).dummy||ie(n,v,f)}o=c+1,i=u}}return r})),n}function ne(e,t){var n={};function r(t,r,i,o,a){var s;for(var l of d(r,i))if(s=t[l],e.node(s).dummy)for(var c of e.predecessors(s)){var h=e.node(c);h.dummy&&(h.order<o||h.order>a)&&ie(n,c,s)}}return t.reduce((function(t,n){for(var i,o=-1,a=0,s=0;s<n.length;s++){var l=s,c=n[s];if(void 0!==c){if("border"===e.node(c).dummy){var h=e.predecessors(c);h.length&&(r(n,a,l,o,i=e.node(h[0]).order),a=l,o=i)}r(n,a,n.length,i,t.length)}}return n})),n}function re(e,t){if(e.node(t).dummy)for(var n of e.predecessors(t))if(e.node(n).dummy)return n}function ie(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function oe(e,t,n){if(t>n){var r=t;t=n,n=r}return s(e[t],n)}function ae(e,t,n,r){var i={},o={},a={};for(var s of t)for(var l=0;l<s.length;l++)i[h=s[l]]=h,o[h]=h,a[h]=l;for(var s of t){var c=-1;for(var h of s){var d=r(h);if(d.length)for(var f=((d=u(d,(e=>a[e]))).length-1)/2,v=Math.floor(f),p=Math.ceil(f);v<=p;++v){var g=d[v];o[h]===h&&c<a[g]&&!oe(n,h,g)&&(o[g]=h,o[h]=i[h]=i[g],c=a[g])}}}return{root:i,align:o}}function se(e,t,n,r,i){var o={},a=function(e,t,n,r){var i=new S,o=e.graph(),a=ue(o.nodesep,o.edgesep,r);for(var s of t){var l=null;for(var c of s){var h=n[c];if(i.setNode(h),l){var d=n[l],u=i.edge(d,h);i.setEdge(d,h,Math.max(a(e,c,l),u||0))}l=c}}return i}(e,t,n,i),s=i?"borderLeft":"borderRight";function l(e,t){for(var n=a.nodes(),r=n.pop(),i={};r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}for(var c of(l((function(e){o[e]=a.inEdges(e).reduce((function(e,t){return Math.max(e,o[t.v]+a.edge(t))}),0)}),(e=>a.predecessors(e))),l((function(t){var n=a.outEdges(t).reduce((function(e,t){return Math.min(e,o[t.w]-a.edge(t))}),Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==s&&(o[t]=Math.max(o[t],n))}),(e=>a.successors(e))),Object.keys(r))){var h=r[c];o[h]=o[n[h]]}return o}function le(e,t){return h(v(t),(function(t){var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;for(var i in t){var o=t[i],a=fe(e,i)/2;n=Math.max(o+a,n),r=Math.min(o-a,r)}return n-r}))}function ce(e,t){var n=v(t),r=Math.min(...n),i=Math.max(...n);for(var o of["ul","ur","dl","dr"]){var a=o[1],s=e[o];if(s!==t){var l=v(s),h="l"===a?r-Math.min(...l):i-Math.max(...l);h&&(e[o]=c(s,(e=>e+h)))}}}function he(e,t){return c(e.ul,(function(n,r){if(t)return e[t.toLowerCase()][r];var i=u([e.ul[r],e.ur[r],e.dl[r],e.dr[r]],(e=>e));return(i[1]+i[2])/2}))}function de(e){var t,n=A(e),r=Object.assign(Object.assign({},te(e,n)),ne(e,n)),i={ul:{},ur:{},dl:{},dr:{}};for(var o of["u","d"])for(var a of(t="u"===o?n:n.map((e=>e)).reverse(),["l","r"])){"r"===a&&(t=t.map((e=>e.map((e=>e)).reverse())));var s=ae(0,t,r,("u"===o?e.predecessors:e.successors).bind(e)),l=se(e,t,s.root,s.align,"r"===a);"r"===a&&(l=c(l,(e=>-e))),i[o+a]=l}return ce(i,le(e,i)),he(i,e.graph().align)}function ue(e,t,n){return function(r,i,o){var a,l=r.node(i),c=r.node(o),h=0;if(h+=l.width/2,s(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":a=-l.width/2;break;case"r":a=l.width/2}if(a&&(h+=n?a:-a),a=0,h+=(l.dummy?t:e)/2,h+=(c.dummy?t:e)/2,h+=c.width/2,s(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":a=c.width/2;break;case"r":a=-c.width/2}return a&&(h+=n?a:-a),a=0,h}}function fe(e,t){return e.node(t).width}var ve=Object.freeze({__proto__:null,findType1Conflicts:te,findType2Conflicts:ne,findOtherInnerSegmentNode:re,addConflict:ie,hasConflict:oe,verticalAlignment:ae,horizontalCompaction:se,findSmallestWidthAlignment:le,alignCoordinates:ce,balance:he,positionX:de,sep:ue,width:fe});function pe(e){!function(e){var t=A(e),n=e.graph().ranksep,r=0;for(var i of t){var o=Math.max(...i.map((t=>e.node(t).height)));for(var a of i)e.node(a).y=r+o/2;r+=o+n}}(e=O(e));var t=de(e);for(var n in t)e.node(n).x=t[n]}var ge=Object.freeze({__proto__:null,bk:ve,position:pe});function me(e){var t={};e.sources().forEach((function n(r){var i=e.node(r);if(s(t,r))return i.rank;t[r]=!0;var o=Math.min(...e.outEdges(r).map((t=>n(t.w)-e.edge(t).minlen)));return o!==Number.POSITIVE_INFINITY&&null!=o||(o=0),i.rank=o}))}function ye(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}function we(e){var t,n=new S({directed:!1}),r=e.nodes()[0],i=e.nodeCount();for(n.setNode(r,{});o(e)<i;)t=a(e),s(e,n.hasNode(t.v)?ye(e,t):-ye(e,t));return n;function o(e){return n.nodes().forEach((function t(r){for(var i of e.nodeEdges(r)){var o=i.v,a=r===o?i.w:o;n.hasNode(a)||ye(e,i)||(n.setNode(a,{}),n.setEdge(r,a,{}),t(a))}})),n.nodeCount()}function a(e){return h(e.edges(),(function(t){if(n.hasNode(t.v)!==n.hasNode(t.w))return ye(e,t)}))}function s(e,t){for(var r of n.nodes())e.node(r).rank+=t}}class xe{constructor(){this._arr=[],this._keyIndices={}}size(){return this._arr.length}keys(){return this._arr.map((function(e){return e.key}))}has(e){return e in this._keyIndices}priority(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority}min(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key}add(e,t){var n=this._keyIndices;if(!((e=String(e))in n)){var r=this._arr,i=r.length;return n[e]=i,r.push({key:e,priority:t}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key}decrease(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)}_heapify(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))}_decrease(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t}_swap(e,t){var n=this._arr,r=this._keyIndices,i=n[e],o=n[t];n[e]=o,n[t]=i,r[o.key]=e,r[i.key]=t}}var be=()=>1;function _e(e,t,n,r){return function(e,t,n,r){var i,o,a={},s=new xe,l=function(e){var t=e.v!==i?e.v:e.w,r=a[t],l=n(e),c=o.distance+l;if(l<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+l);c<r.distance&&(r.distance=c,r.predecessor=i,s.decrease(t,c))};for(e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;a[e]={distance:n},s.add(e,n)}));s.size()>0&&(i=s.removeMin(),(o=a[i]).distance!==Number.POSITIVE_INFINITY);)r(i).forEach(l);return a}(e,String(t),n||be,r||function(t){return e.outEdges(t)})}function ke(e){var t=0,n=[],r={},i=[];function o(a){var s=r[a]={onStack:!0,lowlink:t,index:t++};if(n.push(a),e.successors(a).forEach((function(e){e in r?r[e].onStack&&(s.lowlink=Math.min(s.lowlink,r[e].index)):(o(e),s.lowlink=Math.min(s.lowlink,r[e].lowlink))})),s.lowlink===s.index){var l,c=[];do{l=n.pop(),r[l].onStack=!1,c.push(l)}while(a!==l);i.push(c)}}return e.nodes().forEach((function(e){e in r||o(e)})),i}var Ee=()=>1;class Se extends Error{}function Me(e){var t={},n={},r=[];function i(o){if(o in n)throw new Se;if(!(o in t)){for(var a of(n[o]=!0,t[o]=!0,e.predecessors(o)))i(a);delete n[o],r.push(o)}}for(var o of e.sinks())i(o);if(Object.keys(t).length!==e.nodeCount())throw new Se;return r}function Ne(e,t,n){var r=Array.isArray(t)?t:[t],i=(e.isDirected()?e.successors:e.neighbors).bind(e),o=[],a={};for(var s of r){if(!e.hasNode(s))throw new Error("Graph does not have node: "+s);ze(e,s,"post"===n,a,i,o)}return o}function ze(e,t,n,r,i,o){if(!(t in r)){for(var a of(r[t]=!0,n||o.push(t),i(t)))ze(e,a,n,r,i,o);n&&o.push(t)}}function Le(e,t){return Ne(e,t,"post")}function Te(e,t){return Ne(e,t,"pre")}var Ie=Object.freeze({__proto__:null,components:function(e){var t,n={},r=[];function i(r){if(!(r in n)){for(var o of(n[r]=!0,t.push(r),e.successors(r)))i(o);for(var a of e.predecessors(r))i(a)}}for(var o of e.nodes())t=[],i(o),t.length&&r.push(t);return r},dijkstra:_e,dijkstraAll:function(e,t,n){var r={};for(var i of e.nodes())r[i]=_e(e,i,t,n);return r},findCycles:function(e){return ke(e).filter((function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))},floydWarshall:function(e,t,n){return function(e,t,n){var r={},i=e.nodes();return i.forEach((function(e){r[e]={},r[e][e]={distance:0},i.forEach((function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var i=n.v===e?n.w:n.v,o=t(n);r[e][i]={distance:o,predecessor:e}}))})),i.forEach((function(e){var t=r[e];i.forEach((function(n){var o=r[n];i.forEach((function(n){var r=o[e],i=t[n],a=o[n],s=r.distance+i.distance;s<a.distance&&(a.distance=s,a.predecessor=i.predecessor)}))}))})),r}(e,t||Ee,n||function(t){return e.outEdges(t)})},isAcyclic:function(e){try{Me(e)}catch(e){if(e instanceof Se)return!1;throw e}return!0},postorder:Le,preorder:Te,prim:function(e,t){var n,r=new M({}),i={},o=new xe;function a(e){var r=e.v===n?e.w:e.v,a=o.priority(r);if(void 0!==a){var s=t(e);s<a&&(i[r]=n,o.decrease(r,s))}}if(0===e.nodeCount())return r;for(n of e.nodes())o.add(n,Number.POSITIVE_INFINITY),r.setNode(n);o.decrease(e.nodes()[0],0);for(var s=!1;o.size()>0;){if((n=o.removeMin())in i)r.setEdge(n,i[n]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(n).forEach(a)}return r},tarjan:ke,topsort:Me});function Ce(e){me(e=C(e));var t,n=we(e);for(Pe(n),Oe(n,e);t=De(n);)Be(n,e,t,Fe(n,e,t))}function Oe(e,t){var n=Le(e,e.nodes());for(var r of n=n.slice(0,n.length-1))je(e,t,r)}function je(e,t,n){var r=e.node(n).parent;e.edge(n,r).cutvalue=Ae(e,t,n)}function Ae(e,t,n){var r,i,o=e.node(n).parent,a=!0,s=t.edge(n,o),l=0;for(var c of(s||(a=!1,s=t.edge(o,n)),l=s.weight,t.nodeEdges(n))){var h=c.v===n,d=h?c.w:c.v;if(d!==o){var u=h===a,f=t.edge(c).weight;if(l+=u?f:-f,r=n,i=d,e.hasEdge(r,i)){var v=e.edge(n,d).cutvalue;l+=u?-v:v}}}return l}function Pe(e,t){arguments.length<2&&(t=e.nodes()[0]),Re(e,{},1,t)}function Re(e,t,n,r,i){var o=n,a=e.node(r);for(var l of(t[r]=!0,e.neighbors(r)))s(t,l)||(n=Re(e,t,n,l,r));return a.low=o,a.lim=n++,i?a.parent=i:delete a.parent,n}function De(e){for(var t of e.edges())if(e.edge(t).cutvalue<0)return t}function Fe(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var o=e.node(r),a=e.node(i),s=o,l=!1;return o.lim>a.lim&&(s=a,l=!0),h(t.edges().filter((function(t){return l===$e(e,e.node(t.v),s)&&l!==$e(e,e.node(t.w),s)})),(e=>ye(t,e)))}function Be(e,t,n,r){var i=n.v,o=n.w;e.removeEdge(i,o),e.setEdge(r.v,r.w,{}),Pe(e),Oe(e,t),function(e,t){var n=function(e,t){for(var n of e.nodes())if(!t.node(n).parent)return n}(e,t),r=Te(e,n);for(var i of r=r.slice(1)){var o=e.node(i).parent,a=t.edge(i,o),s=!1;a||(a=t.edge(o,i),s=!0),t.node(i).rank=t.node(o).rank+(s?a.minlen:-a.minlen)}}(e,t)}function $e(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}function qe(e){switch(e.graph().ranker){case"network-simplex":default:We(e);break;case"tight-tree":Ge(e);break;case"longest-path":Ve(e)}}Ce.initLowLimValues=Pe,Ce.initCutValues=Oe,Ce.calcCutValue=Ae,Ce.leaveEdge=De,Ce.enterEdge=Fe,Ce.exchangeEdges=Be;var Ve=me;function Ge(e){me(e),we(e)}function We(e){Ce(e)}var He=Object.freeze({__proto__:null,rank:qe,tightTreeRanker:Ge,networkSimplexRanker:We,networkSimplex:Ce,feasibleTree:we,longestPath:me}),Ue=e=>1;function Ye(e,n){if(e.nodeCount()<=1)return[];var r=function(e,n){var r=new S,i=0,o=0;for(var a of e.nodes())r.setNode(a,{v:a,in:0,out:0});for(var s of e.edges()){var l=r.edge(s.v,s.w)||0,c=n(s),h=l+c;r.setEdge(s.v,s.w,h),o=Math.max(o,r.node(s.v).out+=c),i=Math.max(i,r.node(s.w).in+=c)}var d=p(o+i+3,(()=>new t)),u=i+1;for(var a of r.nodes())Ke(d,u,r.node(a));return{graph:r,buckets:d,zeroIdx:u}}(e,n||Ue);return a(function(e,t,n){for(var r,i=[],o=t[t.length-1],a=t[0];e.nodeCount();){for(;r=a.dequeue();)Je(e,t,n,r);for(;r=o.dequeue();)Je(e,t,n,r);if(e.nodeCount())for(var s=t.length-2;s>0;--s)if(r=t[s].dequeue()){i=i.concat(Je(e,t,n,r,!0));break}}return i}(r.graph,r.buckets,r.zeroIdx).map((t=>e.outEdges(t.v,t.w))))}function Je(e,t,n,r,i){var o=i?[]:void 0;for(var a of e.inEdges(r.v)){var s=e.edge(a),l=e.node(a.v);i&&o.push({v:a.v,w:a.w}),l.out-=s,Ke(t,n,l)}for(var a of e.outEdges(r.v)){s=e.edge(a);var c=a.w,h=e.node(c);h.in-=s,Ke(t,n,h)}return e.removeNode(r.v),o}function Ke(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var Qe={run:function(e){var t="greedy"===e.graph().acyclicer?Ye(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],n={},r={};function i(o){if(!s(r,o)){for(var a of(r[o]=!0,n[o]=!0,e.outEdges(o)))s(n,a.w)?t.push(a):i(a.w);delete n[o]}}return e.nodes().forEach(i),t}(e);for(var n of t){var r=e.edge(n);e.removeEdge(n),r.forwardName=n.name,r.reversed=!0,e.setEdge(n.w,n.v,r,f("rev"))}},undo:function(e){for(var t of e.edges()){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}}};function Xe(e){e.children().forEach((function t(n){var r=e.children(n),i=e.node(n);if(r.length&&r.forEach(t),s(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,a=i.maxRank+1;o<a;++o)Ze(e,"borderLeft","_bl",n,i,o),Ze(e,"borderRight","_br",n,i,o)}}))}function Ze(e,t,n,r,i,o){var a={width:0,height:0,rank:o,borderType:t},s=i[t][o-1],l=I(e,"border",a,n);i[t][o]=l,e.setParent(l,r),s&&e.setEdge(s,l,{weight:1})}var et={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||tt(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){for(var t of e.nodes())rt(e.node(t));for(var n of e.edges()){var r=e.edge(n);r.points.forEach(rt),s(r,"y")&&rt(r)}}(e),"lr"!==t&&"rl"!==t||(function(e){for(var t of e.nodes())it(e.node(t));for(var n of e.edges()){var r=e.edge(n);r.points.forEach(it),s(r,"x")&&it(r)}}(e),tt(e))}};function tt(e){for(var t of e.nodes())nt(e.node(t));for(var n of e.edges())nt(e.edge(n))}function nt(e){var t=e.width;e.width=e.height,e.height=t}function rt(e){e.y=-e.y}function it(e){var t=e.x;e.x=e.y,e.y=t}var ot=Object.freeze({__proto__:null,debugOrdering:function(e){var t=A(e),n=new S({compound:!0,multigraph:!0}).setGraph({});for(var r of e.nodes())n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank);for(var i of e.edges())n.setEdge(i.v,i.w,{},i.name);var o=0;for(var a of t){var s="layer"+o;o++,n.setNode(s,{rank:"same"}),a.reduce((function(e,t){return n.setEdge(e.toString(),t,{style:"invis"}),t}))}return n}}),at={run:function(e){for(var t of(e.graph().dummyChains=[],e.edges()))st(e,t)},undo:function(e){for(var t of e.graph().dummyChains){var n,r=e.node(t),i=r.edgeLabel;for(e.setEdge(r.edgeObj,i);r.dummy;)n=e.successors(t)[0],e.removeNode(t),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),t=n,r=e.node(t)}}};function st(e,t){var n=t.v,r=e.node(n).rank,i=t.w,o=e.node(i).rank,a=t.name,s=e.edge(t),l=s.labelRank;if(o!==r+1){var c,h,d;for(e.removeEdge(t),d=0,++r;r<o;++d,++r)s.points=[],c=I(e,"edge",h={width:0,height:0,edgeLabel:s,edgeObj:t,rank:r},"_d"),r===l&&(h.width=s.width,h.height=s.height,h.dummy="edge-label",h.labelpos=s.labelpos),e.setEdge(n,c,{weight:s.weight},a),0===d&&e.graph().dummyChains.push(c),n=c;e.setEdge(n,i,{weight:s.weight},a)}}function lt(e){var t=function(e){var t={},n=0;function r(i){var o=n;e.children(i).forEach(r),t[i]={low:o,lim:n++}}return e.children().forEach(r),t}(e);for(var n of e.graph().dummyChains)for(var r=e.node(n),i=r.edgeObj,o=ct(e,t,i.v,i.w),a=o.path,s=o.lca,l=0,c=a[l],h=!0;n!==i.w;){if(r=e.node(n),h){for(;(c=a[l])!==s&&e.node(c).maxRank<r.rank;)l++;c===s&&(h=!1)}if(!h){for(;l<a.length-1&&e.node(c=a[l+1]).minRank<=r.rank;)l++;c=a[l]}e.setParent(n,c),n=e.successors(n)[0]}}function ct(e,t,n,r){var i,o,a=[],s=[],l=Math.min(t[n].low,t[r].low),c=Math.max(t[n].lim,t[r].lim);i=n;do{i=e.parent(i),a.push(i)}while(i&&(t[i].low>l||c>t[i].lim));for(o=i,i=r;(i=e.parent(i))!==o;)s.push(i);return{path:a.concat(s.reverse()),lca:o}}var ht={run:function(e){var t=I(e,"root",{},"_root"),n=function(e){var t={};function n(r,i){var o=e.children(r);if(o&&o.length)for(var a of o)n(a,i+1);t[r]=i}for(var r of e.children())n(r,1);return t}(e),r=Math.max(...v(n))-1,i=2*r+1;for(var o of(e.graph().nestingRoot=t,e.edges()))e.edge(o).minlen*=i;var a=function(e){return e.edges().reduce(((t,n)=>t+e.edge(n).weight),0)}(e)+1;for(var s of e.children())dt(e,t,i,a,r,n,s);e.graph().nodeRankFactor=i},cleanup:function(e){var t=e.graph();for(var n of(e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges()))e.edge(n).nestingEdge&&e.removeEdge(n)}};function dt(e,t,n,r,i,o,a){var s=e.children(a);if(s.length){var l=D(e,"_bt"),c=D(e,"_bb"),h=e.node(a);for(var d of(e.setParent(l,a),h.borderTop=l,e.setParent(c,a),h.borderBottom=c,s)){dt(e,t,n,r,i,o,d);var u=e.node(d),f=u.borderTop?u.borderTop:d,v=u.borderBottom?u.borderBottom:d,p=u.borderTop?r:2*r,g=f!==v?1:i-o[a]+1;e.setEdge(l,f,{weight:p,minlen:g,nestingEdge:!0}),e.setEdge(v,c,{weight:p,minlen:g,nestingEdge:!0})}e.parent(a)||e.setEdge(t,l,{weight:0,minlen:i+o[a]})}else a!==t&&e.setEdge(t,a,{weight:0,minlen:n})}function ut(e){return"edge-proxy"==e.dummy}function ft(e){return"selfedge"==e.dummy}var vt=50,pt=20,gt=50,mt="tb",yt=1,wt=1,xt=0,bt=0,_t=10,kt="r";function Et(e={}){var t={};for(var n of Object.keys(e))t[n.toLowerCase()]=e[n];return t}function St(e){return e.nodes().map((function(t){var n=e.node(t),r=e.parent(t),i={v:t};return void 0!==n&&(i.value=n),void 0!==r&&(i.parent=r),i}))}function Mt(e){return e.edges().map((function(t){var n=e.edge(t),r={v:t.v,w:t.w};return void 0!==t.name&&(r.name=t.name),void 0!==n&&(r.value=n),r}))}var Nt=Object.freeze({__proto__:null,write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:St(e),edges:Mt(e)};return void 0!==e.graph()&&(t.value=JSON.parse(JSON.stringify(e.graph()))),t},read:function(e){var t=new S(e.options).setGraph(e.value);for(var n of e.nodes)t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent);for(var n of e.edges)t.setEdge({v:n.v,w:n.w,name:n.name},n.value);return t}}),zt={Graph:S,GraphLike:M,alg:Ie,json:Nt,PriorityQueue:xe};e.Graph=S,e.GraphLike=M,e.PriorityQueue=xe,e.acyclic=Qe,e.addBorderSegments=Xe,e.alg=Ie,e.coordinateSystem=et,e.data=i,e.debug=ot,e.graphlib=zt,e.greedyFAS=Ye,e.json=Nt,e.layout=function(e,t){var n=t&&t.debugTiming?$:q;n("layout",(function(){var t=n("  buildLayoutGraph",(function(){return function(e){var t,n,r,i,o,a,s,l,c,h,d,u,f,v,p,g=new S({multigraph:!0,compound:!0}),m=Et(e.graph()),y={nodesep:null!==(t=m.nodesep)&&void 0!==t?t:gt,edgesep:null!==(n=m.edgesep)&&void 0!==n?n:pt,ranksep:null!==(r=m.ranksep)&&void 0!==r?r:vt,marginx:+(null!==(i=m.marginx)&&void 0!==i?i:0),marginy:+(null!==(o=m.marginy)&&void 0!==o?o:0),acyclicer:m.acyclicer,ranker:null!==(a=m.ranker)&&void 0!==a?a:"network-simplex",rankdir:null!==(s=m.rankdir)&&void 0!==s?s:mt,align:m.align};for(var w of(g.setGraph(y),e.nodes())){var x=Et(e.node(w)),b={width:+(null!==(l=x&&x.width)&&void 0!==l?l:0),height:+(null!==(c=x&&x.height)&&void 0!==c?c:0)};g.setNode(w,b),g.setParent(w,e.parent(w))}for(var _ of e.edges()){var k=Et(e.edge(_)),E={minlen:null!==(h=k.minlen)&&void 0!==h?h:yt,weight:null!==(d=k.weight)&&void 0!==d?d:wt,width:null!==(u=k.width)&&void 0!==u?u:xt,height:null!==(f=k.height)&&void 0!==f?f:bt,labeloffset:null!==(v=k.labeloffset)&&void 0!==v?v:_t,labelpos:null!==(p=k.labelpos)&&void 0!==p?p:kt};g.setEdge(_,E)}return g}(e)}));n("  runLayout",(function(){!function(e,t){t("    makeSpaceForEdgeLabels",(function(){!function(e){var t=e.graph();for(var n of(t.ranksep/=2,e.edges())){var r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}}(e)})),t("    removeSelfEdges",(function(){!function(e){for(var t of e.edges())if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}(e)})),t("    acyclic",(function(){Qe.run(e)})),t("    nestingGraph.run",(function(){ht.run(e)})),t("    rank",(function(){qe(O(e))})),t("    injectEdgeLabelProxies",(function(){!function(e){for(var t of e.edges()){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i=e.node(t.w);I(e,"edge-proxy",{rank:(i.rank-r.rank)/2+r.rank,e:t},"_ep")}}}(e)})),t("    removeEmptyRanks",(function(){R(e)})),t("    nestingGraph.cleanup",(function(){ht.cleanup(e)})),t("    normalizeRanks",(function(){P(e)})),t("    assignRankMinMax",(function(){!function(e){var t=0;for(var n of e.nodes()){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Math.max(t,r.maxRank))}e.graph().maxRank=t}(e)})),t("    removeEdgeLabelProxies",(function(){!function(e){for(var t of e.nodes()){var n=e.node(t);ut(n)&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}}(e)})),t("    normalize.run",(function(){at.run(e)})),t("    parentDummyChains",(function(){lt(e)})),t("    addBorderSegments",(function(){Xe(e)})),t("    order",(function(){K(e)})),t("    insertSelfEdges",(function(){!function(e){var t,n=A(e);for(var r of n)for(var i=0,o=0;o<r.length;o++){var a=r[o],s=e.node(a);for(var l of(s.order=o+i,null!==(t=s.selfEdges)&&void 0!==t?t:[]))I(e,"selfedge",{width:l.label.width,height:l.label.height,rank:s.rank,order:o+ ++i,e:l.e,label:l.label},"_se");delete s.selfEdges}}(e)})),t("    adjustCoordinateSystem",(function(){et.adjust(e)})),t("    position",(function(){pe(e)})),t("    positionSelfEdges",(function(){!function(e){for(var t of e.nodes()){var n=e.node(t);if(ft(n)){var r=e.node(n.e.v),i=r.x+r.width/2,o=r.y,a=n.x-i,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*a/3,y:o-s},{x:i+5*a/6,y:o-s},{x:i+a,y:o},{x:i+5*a/6,y:o+s},{x:i+2*a/3,y:o+s}],n.label.x=n.x,n.label.y=n.y}}}(e)})),t("    removeBorderNodes",(function(){!function(e){for(var t of e.nodes())if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),o=e.node(l(n.borderLeft)),a=e.node(l(n.borderRight));n.width=Math.abs(a.x-o.x),n.height=Math.abs(i.y-r.y),n.x=o.x+n.width/2,n.y=r.y+n.height/2}for(var t of e.nodes())"border"===e.node(t).dummy&&e.removeNode(t)}(e)})),t("    normalize.undo",(function(){at.undo(e)})),t("    fixupEdgeLabelCoords",(function(){!function(e){for(var t of e.edges()){var n=e.edge(t);if(s(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}}(e)})),t("    undoCoordinateSystem",(function(){et.undo(e)})),t("    translateGraph",(function(){!function(e){var t,n,r,i=Number.POSITIVE_INFINITY,o=0,a=Number.POSITIVE_INFINITY,l=0,c=e.graph(),h=null!==(t=c.marginx)&&void 0!==t?t:0,d=null!==(n=c.marginy)&&void 0!==n?n:0;function u(e){var t=e.x,n=e.y,r=e.width,s=e.height;i=Math.min(i,t-r/2),o=Math.max(o,t+r/2),a=Math.min(a,n-s/2),l=Math.max(l,n+s/2)}for(var f of e.nodes())u(e.node(f));for(var v of e.edges())s(g=e.edge(v),"x")&&u(g);for(var f of(i-=h,a-=d,e.nodes())){var p=e.node(f);p.x-=i,p.y-=a}for(var v of e.edges()){var g=e.edge(v);for(var m of null!==(r=g.points)&&void 0!==r?r:[])m.x-=i,m.y-=a;g.hasOwnProperty("x")&&(g.x-=i),g.hasOwnProperty("y")&&(g.y-=a)}c.width=o-i+h,c.height=l-a+d}(e)})),t("    assignNodeIntersects",(function(){!function(e){for(var t of e.edges()){var n,r,i=e.edge(t),o=e.node(t.v),a=e.node(t.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=a,r=o),i.points.unshift(j(o,n)),i.points.push(j(a,r))}}(e)})),t("    reversePoints",(function(){!function(e){for(var t of e.edges()){var n=e.edge(t);n.reversed&&n.points.reverse()}}(e)})),t("    acyclic.undo",(function(){Qe.undo(e)}))}(t,n)})),n("  updateInputGraph",(function(){!function(e,t){for(var n of e.nodes()){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}for(var o of e.edges()){var a=e.edge(o),l=t.edge(o);a.points=l.points,s(l,"x")&&(a.x=l.x,a.y=l.y)}e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)}))}))},e.nestingGraph=ht,e.normalize=at,e.order=ee,e.parentDummyChains=lt,e.position=ge,e.rank=He,e.util=V,e.version="0.1.3",Object.defineProperty(e,"__esModule",{value:!0})}(t)}(0,E.exports)),E.exports}var M=m(Object.freeze({__proto__:null,default:{}}));!function(e,t){!function(e,t){function n(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function r([e,t],n){for(var r=[],i=0;i<n;i++)r.push(e+(t-e)*i/(n-1));return r}function i(e,t){for(var n=0,r=0,i=e.length;n<i;n++)r+=t(e[n]);return r}function o(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}function a(e){return e[e.length-1]}function s(e,t){return""===t||!!e&&-1!==e.indexOf(t)}function l(e,t){for(var n={},r=0;r<e.length;r++)n[e[r][t]]=e[r];return n}function c(e,t){for(var n={},r=[],i=0;i<e.length;i++){var o=e[i][t];n[o]||(n[o]=!0,r.push(e[i]))}return r}var h=Object.freeze({__proto__:null,range:r,sum:i,find:o,last:a,hasSubstring:s,indexBy:l,uniqueBy:c});function d(e,t,n={}){return{title:{bold:t.bold||!1,underline:t.underline||!1,italic:t.italic||!1,center:t.center||!1},body:{bold:n.bold||!1,underline:n.underline||!1,italic:n.italic||!1,center:n.center||!1},dashed:e.dashed||!1,fill:e.fill||void 0,stroke:e.stroke||void 0,visual:e.visual||"class",direction:e.direction||void 0}}var u={ABSTRACT:d({visual:"class"},{center:!0,italic:!0}),ACTOR:d({visual:"actor"},{center:!0},{center:!0}),CHOICE:d({visual:"rhomb"},{center:!0},{center:!0}),CLASS:d({visual:"class"},{center:!0,bold:!0}),DATABASE:d({visual:"database"},{center:!0,bold:!0},{center:!0}),END:d({visual:"end"},{}),FRAME:d({visual:"frame"},{}),HIDDEN:d({visual:"hidden"},{}),INPUT:d({visual:"input"},{center:!0}),INSTANCE:d({visual:"class"},{center:!0,underline:!0}),LABEL:d({visual:"none"},{center:!0}),LOLLIPOP:d({visual:"lollipop"},{center:!0}),NOTE:d({visual:"note"},{}),PACKAGE:d({visual:"package"},{}),RECEIVER:d({visual:"receiver"},{}),REFERENCE:d({visual:"class",dashed:!0},{center:!0}),SENDER:d({visual:"sender"},{}),SOCKET:d({visual:"socket"},{}),START:d({visual:"start"},{}),STATE:d({visual:"roundrect"},{center:!0}),SYNC:d({visual:"sync"},{center:!0}),TABLE:d({visual:"table"},{center:!0,bold:!0}),TRANSCEIVER:d({visual:"transceiver"},{}),USECASE:d({visual:"ellipse"},{center:!0},{center:!0})};function f(e,t){t.width=Math.max(...t.compartments.map((e=>e.width))),t.height=i(t.compartments,(e=>e.height)),t.dividers=[];var n=0;for(var r of t.compartments)r.x=0,r.y=n,r.width=t.width,n+=r.height,r!=a(t.compartments)&&t.dividers.push([{x:0,y:n},{x:t.width,y:n}])}function v(e,t){t.dividers=[],t.compartments=[],t.width=2.5*e.fontSize,t.height=2.5*e.fontSize}function p(e,t){t.width=1.5*e.fontSize,t.height=1.5*e.fontSize,t.dividers=[];var n="LR"==e.direction?t.height-e.padding:-t.height/2;for(var r of t.compartments)"LR"==e.direction?(r.x=t.width/2-r.width/2,r.y=n):(r.x=t.width/2+e.padding/2,r.y=n),n+=r.height}var g={actor:function(e,t){t.width=Math.max(2*e.padding,...t.compartments.map((e=>e.width))),t.height=3*e.padding+i(t.compartments,(e=>e.height)),t.dividers=[];var n=3*e.padding;for(var r of t.compartments)r.x=0,r.y=n,r.width=t.width,n+=r.height,r!=a(t.compartments)&&t.dividers.push([{x:e.padding,y:n},{x:t.width-e.padding,y:n}])},class:f,database:function(e,t){t.width=Math.max(...t.compartments.map((e=>e.width))),t.height=i(t.compartments,(e=>e.height))+2*e.padding,t.dividers=[];var n=1.5*e.padding;for(var o of t.compartments)if(o.x=0,o.y=n,o.width=t.width,n+=o.height,o!=a(t.compartments)){var s=r([0,Math.PI],16).map((r=>({x:.5*t.width*(1-Math.cos(r)),y:n+e.padding*(.75*Math.sin(r)-.5)})));t.dividers.push(s)}},ellipse:function(e,t){var n=Math.max(...t.compartments.map((e=>e.width))),r=i(t.compartments,(e=>e.height));t.width=1.25*n,t.height=1.25*r,t.dividers=[];var o=.125*r,s=e=>e*e,l=e=>Math.sqrt(s(.5)-s(e/t.height-.5))*t.width;for(var c of t.compartments)c.x=.125*n,c.y=o,c.width=n,o+=c.height,c!=a(t.compartments)&&t.dividers.push([{x:t.width/2+l(o)-1,y:o},{x:t.width/2-l(o)+1,y:o}])},end:v,frame:function(e,t){var n=t.compartments[0].width,r=t.compartments[0].height;t.compartments[0].width+=r/2,f(e,t),t.dividers.length&&t.dividers.shift(),t.dividers.unshift([{x:0,y:r},{x:n-r/4,y:r},{x:n+r/4,y:r/2},{x:n+r/4,y:0}])},hidden:function(e,t){t.dividers=[],t.compartments=[],t.width=1,t.height=1},input:f,lollipop:p,none:f,note:f,package:f,receiver:f,rhomb:function(e,t){var n=Math.max(...t.compartments.map((e=>e.width))),r=i(t.compartments,(e=>e.height));t.width=1.5*n,t.height=1.5*r,t.dividers=[];var o=.25*r;for(var s of t.compartments){s.x=.25*n,s.y=o,s.width=n,o+=s.height;var l=t.width/t.height;s!=a(t.compartments)&&t.dividers.push([{x:t.width/2+(o<t.height/2?o*l:(t.height-o)*l),y:o},{x:t.width/2-(o<t.height/2?o*l:(t.height-o)*l),y:o}])}},roundrect:f,sender:f,socket:p,start:v,sync:function(e,t){t.dividers=[],t.compartments=[],"LR"==e.direction?(t.width=3*e.lineWidth,t.height=5*e.fontSize):(t.width=5*e.fontSize,t.height=3*e.lineWidth)},table:function(e,t){if(1!=t.compartments.length){var n=t.compartments.slice(1),r=[[]];for(var i of n)!g()&&v(i)&&a(r).length?r.push([]):p()?r.push([i]):a(r).push(i);var o=t.compartments[0],s=Math.max(o.width/r[0].length,...n.map((e=>e.width))),l=Math.max(...n.map((e=>e.height)));t.width=s*r[0].length,t.height=o.height+l*r.length;var c=o.height;t.dividers=[[{x:0,y:o.height},{x:0,y:o.height}],...r.map(((e,n)=>[{x:0,y:c+n*l},{x:t.width,y:c+n*l}])),...r[0].map(((e,n)=>[{x:(n+1)*s,y:c},{x:(n+1)*s,y:t.height}]))],o.x=0,o.y=0,o.width=t.width;for(var h=0;h<r.length;h++)for(var d=0;d<r[h].length;d++){var u=r[h][d];u.x=d*s,u.y=c+h*l,u.width=s}t.compartments=t.compartments.filter((e=>!v(e)))}else f(e,t);function v(e){return!e.lines.length&&!e.nodes.length&&!e.relations.length}function p(e){var t=a(r);return r[0]!=t&&r[0].length==t.length}function g(e){return i==a(n)}},transceiver:f},m={actor:function(e,t,n,r,i){var o=r.padding/2,a=n+4*o,s={x:e.x,y:a-o};i.circle(s,o).fillAndStroke(),i.path([{x:e.x,y:a},{x:e.x,y:a+2*o}]).stroke(),i.path([{x:e.x-o,y:a+o},{x:e.x+o,y:a+o}]).stroke(),i.path([{x:e.x-o,y:a+o+r.padding},{x:e.x,y:a+r.padding},{x:e.x+o,y:a+o+r.padding}]).stroke()},class:function(e,t,n,r,i){i.rect(t,n,e.width,e.height).fillAndStroke()},database:function(e,t,n,r,i){var o=r.padding,a=n-o/2,s=3.1416;i.rect(t,n+o,e.width,e.height-1.5*o).fill(),i.path([{x:t,y:a+1.5*o},{x:t,y:a-.5*o+e.height}]).stroke(),i.path([{x:t+e.width,y:a+1.5*o},{x:t+e.width,y:a-.5*o+e.height}]).stroke(),i.ellipse({x:e.x,y:a+1.5*o},e.width,1.5*o).fillAndStroke(),i.ellipse({x:e.x,y:a-.5*o+e.height},e.width,1.5*o,0,s).fillAndStroke()},ellipse:function(e,t,n,r,i){i.ellipse({x:e.x,y:e.y},e.width,e.height).fillAndStroke()},end:function(e,t,n,r,i){i.circle({x:e.x,y:n+e.height/2},e.height/3).fillAndStroke(),i.fillStyle(r.stroke),i.circle({x:e.x,y:n+e.height/2},e.height/3-r.padding/2).fill()},frame:function(e,t,n,r,i){i.rect(t,n,e.width,e.height).fillAndStroke()},hidden:function(e,t,n,r,i){},input:function(e,t,n,r,i){i.circuit([{x:t+r.padding,y:n},{x:t+e.width,y:n},{x:t+e.width-r.padding,y:n+e.height},{x:t,y:n+e.height}]).fillAndStroke()},lollipop:function(e,t,n,r,i){i.circle({x:e.x,y:n+e.height/2},e.height/2.5).fillAndStroke()},none:function(e,t,n,r,i){},note:function(e,t,n,r,i){i.circuit([{x:t,y:n},{x:t+e.width-r.padding,y:n},{x:t+e.width,y:n+r.padding},{x:t+e.width,y:n+e.height},{x:t,y:n+e.height},{x:t,y:n}]).fillAndStroke(),i.path([{x:t+e.width-r.padding,y:n},{x:t+e.width-r.padding,y:n+r.padding},{x:t+e.width,y:n+r.padding}]).stroke()},package:function(e,t,n,r,i){var o=e.compartments[0].height;i.rect(t,n+o,e.width,e.height-o).fillAndStroke();var a=i.measureText(e.name).width+2*r.padding;i.circuit([{x:t,y:n+o},{x:t,y:n},{x:t+a,y:n},{x:t+a,y:n+o}]).fillAndStroke()},receiver:function(e,t,n,r,i){i.circuit([{x:t-r.padding,y:n},{x:t+e.width,y:n},{x:t+e.width,y:n+e.height},{x:t-r.padding,y:n+e.height},{x:t,y:n+e.height/2}]).fillAndStroke()},rhomb:function(e,t,n,r,i){i.circuit([{x:e.x,y:n},{x:t+e.width,y:e.y},{x:e.x,y:n+e.height},{x:t,y:e.y}]).fillAndStroke()},roundrect:function(e,t,n,r,i){var o=Math.min(2*r.padding*r.leading,e.height/2);i.roundRect(t,n,e.width,e.height,o).fillAndStroke()},sender:function(e,t,n,r,i){i.circuit([{x:t,y:n},{x:t+e.width-r.padding,y:n},{x:t+e.width,y:n+e.height/2},{x:t+e.width-r.padding,y:n+e.height},{x:t,y:n+e.height}]).fillAndStroke()},socket:function(e,t,n,r,i){var o="TB"===r.direction?Math.PI:Math.PI/2,a="TB"===r.direction?2*Math.PI:-Math.PI/2;i.ellipse({x:e.x,y:e.y},e.width,e.height,o,a).stroke()},start:function(e,t,n,r,i){i.fillStyle(r.stroke),i.circle({x:e.x,y:n+e.height/2},e.height/2.5).fill()},sync:function(e,t,n,r,i){i.fillStyle(r.stroke),i.rect(t,n,e.width,e.height).fillAndStroke()},table:function(e,t,n,r,i){i.rect(t,n,e.width,e.height).fillAndStroke()},transceiver:function(e,t,n,r,i){i.circuit([{x:t-r.padding,y:n},{x:t+e.width-r.padding,y:n},{x:t+e.width,y:n+e.height/2},{x:t+e.width-r.padding,y:n+e.height},{x:t-r.padding,y:n+e.height},{x:t,y:n+e.height/2}]).fillAndStroke()}};function y(e,n,r){function i(t,r){return t.length?(e.setFont(n.font,n.fontSize,r,"normal"),{width:Math.round(Math.max(...t.map(e.textWidth))+2*n.padding),height:Math.round(e.textHeight()*t.length+2*n.padding)}):{width:0,height:n.padding}}function o(e,r,o){var u,f,v=i(e.lines,r?"normal":"bold");if(!e.nodes.length&&!e.relations.length)return e.width=v.width,e.height=v.height,void(e.offset={x:n.padding,y:n.padding});var p=Object.assign(Object.assign({},n),{direction:null!==(u=o.direction)&&void 0!==u?u:n.direction});e.nodes.forEach((e=>d(e,p)));var g=new t.graphlib.Graph;for(var m of(g.setGraph({rankdir:o.direction||n.direction,nodesep:n.spacing,edgesep:n.spacing,ranksep:n.spacing,acyclicer:n.acyclicer,ranker:n.ranker}),e.nodes))g.setNode(m.name,{width:m.layoutWidth,height:m.layoutHeight});for(var y of e.relations)y.assoc.indexOf("_")>-1?g.setEdge(y.start,y.end,{id:y.id,minlen:0}):1!=(null!==(f=n.gravity)&&void 0!==f?f:1)?g.setEdge(y.start,y.end,{id:y.id,minlen:n.gravity}):g.setEdge(y.start,y.end,{id:y.id});t.layout(g);var w=l(e.relations,"id"),x=l(e.nodes,"name");g.nodes().forEach((e=>{var t=g.node(e);x[e].x=t.x,x[e].y=t.y}));var b=0,_=0,k=0,E=0;g.edges().forEach((e=>{var t=g.edge(e),n=x[e.v],r=x[e.w],i=w[t.id];i.path=[n,...t.points,r].map(a);var o=i.path[1],l=i.path[i.path.length-2];s(i.startLabel,o,h(c(o,n,4),n,r)),s(i.endLabel,l,h(c(l,r,2),r,n)),b=Math.min(b,i.startLabel.x,i.endLabel.x,...t.points.map((e=>e.x)),...t.points.map((e=>e.x))),_=Math.max(_,i.startLabel.x+i.startLabel.width,i.endLabel.x+i.endLabel.width,...t.points.map((e=>e.x))),k=Math.min(k,i.startLabel.y,i.endLabel.y,...t.points.map((e=>e.y))),E=Math.max(E,i.startLabel.y+i.startLabel.height,i.endLabel.y+i.endLabel.height,...t.points.map((e=>e.y)))}));var S=g.graph(),M=Math.max(S.width,_-b),N=Math.max(S.height,E-k),z=N?N+2*n.gutter:0,L=M?M+2*n.gutter:0;e.width=Math.max(v.width,L)+2*n.padding,e.height=v.height+z+n.padding,e.offset={x:n.padding-b,y:n.padding-k}}function a(e){return{x:e.x,y:e.y}}function s(t,r,i){if(t.text){var o=n.fontSize,a=t.text.split("`");t.width=Math.max(...a.map((t=>e.textWidth(t)))),t.height=o*a.length,t.x=r.x+(1==i||4==i?n.padding:-t.width-n.padding),t.y=r.y+(3==i||4==i?n.padding:-t.height-n.padding)}else t.width=0,t.height=0,t.x=r.x,t.y=r.y}function c(e,t,n){return e.x<t.x&&e.y<t.y?1:e.x>t.x&&e.y<t.y?2:e.x>t.x&&e.y>t.y?3:e.x<t.x&&e.y>t.y?4:n}function h(e,t,r){if(r.x==t.x||r.y==t.y)return e;var i=[4,3,2,1],o=[2,1,4,3];if((r.y<t.y?r.x<t.x?2:1:r.x<t.x?3:4)===e){if("LR"===n.direction)return i[e-1];if("TB"===n.direction)return o[e-1]}return e}function d(e,t){var n=t.styles[e.type]||u.CLASS;e.compartments.forEach(((e,t)=>o(e,t,n))),g[n.visual](t,e),e.layoutWidth=e.width+2*t.edgeMargin,e.layoutHeight=e.height+2*t.edgeMargin}return o(r,0,u.CLASS),r}class w{constructor(e,t,n){this.lines=e,this.nodes=t,this.relations=n}}class x{}class b{constructor(e,t,n){this.type=e,this.name=t,this.compartments=n,this.dividers=[]}}var _=function(){var e=function(e,t,n,r){for(n=n||{},r=e.length;r--;n[e[r]]=t);return n},t=[1,5],n=[1,8],r=[5,6,12,14],i=[12,14],o=[1,22],a={trace:function(){},yy:{},symbols_:{error:2,root:3,compartment:4,EOF:5,SEP:6,slot:7,IDENT:8,class:9,association:10,parts:11,"|":12,"[":13,"]":14,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"SEP",8:"IDENT",12:"|",13:"[",14:"]"},productions_:[0,[3,2],[3,3],[3,4],[3,3],[7,1],[7,1],[7,1],[4,1],[4,3],[11,1],[11,3],[11,2],[10,3],[9,3]],performAction:function(e,t,n,r,i,o,a){var s=o.length-1;switch(i){case 1:case 2:return o[s-1];case 3:case 4:return o[s-2];case 5:this.$=o[s].trim().replace(/\\(\[|\]|\|)/g,"$1");break;case 6:case 7:this.$=o[s];break;case 8:case 10:this.$=[o[s]];break;case 9:this.$=o[s-2].concat(o[s]);break;case 11:this.$=o[s-2].concat([o[s]]);break;case 12:this.$=o[s-1].concat([[]]);break;case 13:var l=o[s-1].trim().replace(/\\(\[|\]|\|)/g,"$1").match("^(.*?)([)<:o+(]*[-_]/?[-_]*[):o+>(]*)(.*)$");if(!l)throw new Error("line "+a[s].first_line+": Classifiers must be separated by a relation or a line break");this.$={assoc:l[2],start:o[s-2],end:o[s],startLabel:l[1].trim(),endLabel:l[3].trim()};break;case 14:var c="CLASS",h=o[s-1][0][0],d=o[s-1][0][0].match("<([a-z]*)>(.*)");d&&(c=d[1].toUpperCase(),h=d[2].trim()),o[s-1][0][0]=h,this.$={type:c,id:h,parts:o[s-1]}}},table:[{3:1,4:2,6:[1,3],7:4,8:t,9:6,10:7,13:n},{1:[3]},{5:[1,9],6:[1,10]},{4:11,7:4,8:t,9:6,10:7,13:n},e(r,[2,8]),e(r,[2,5]),e(r,[2,6],{8:[1,12]}),e(r,[2,7]),{4:14,7:4,8:t,9:6,10:7,11:13,13:n},{1:[2,1]},{5:[1,15],7:16,8:t,9:6,10:7,13:n},{5:[1,17],6:[1,18]},{9:19,13:n},{12:[1,21],14:[1,20]},e(i,[2,10],{6:o}),{1:[2,4]},e(r,[2,9]),{1:[2,2]},{5:[1,23],7:16,8:t,9:6,10:7,13:n},e(r,[2,13]),e([5,6,8,12,14],[2,14]),e(i,[2,12],{7:4,9:6,10:7,4:24,8:t,13:n}),{7:16,8:t,9:6,10:7,13:n},{1:[2,3]},e(i,[2,11],{6:o})],defaultActions:{9:[2,1],15:[2,4],17:[2,2],23:[2,3]},parseError:function(e,t){if(!t.recoverable){var n=new Error(e);throw n.hash=t,n}this.trace(e)},parse:function(e){var t=this,n=[0],r=[null],i=[],o=this.table,a="",s=0,l=0,c=2,h=1,d=i.slice.call(arguments,1),u=Object.create(this.lexer),f={yy:{}};for(var v in this.yy)Object.prototype.hasOwnProperty.call(this.yy,v)&&(f.yy[v]=this.yy[v]);u.setInput(e,f.yy),f.yy.lexer=u,f.yy.parser=this,void 0===u.yylloc&&(u.yylloc={});var p=u.yylloc;i.push(p);var g=u.options&&u.options.ranges;"function"==typeof f.yy.parseError?this.parseError=f.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var m,y,w,x,b,_,k,E,S=function(){var e;return"number"!=typeof(e=u.lex()||h)&&(e=t.symbols_[e]||e),e},M={};;){if(y=n[n.length-1],this.defaultActions[y]?w=this.defaultActions[y]:(null==m&&(m=S()),w=o[y]&&o[y][m]),void 0===w||!w.length||!w[0]){var N="";for(b in E=[],o[y])this.terminals_[b]&&b>c&&E.push("'"+this.terminals_[b]+"'");N=u.showPosition?"Parse error on line "+(s+1)+":\n"+u.showPosition()+"\nExpecting "+E.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(s+1)+": Unexpected "+(m==h?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(N,{text:u.match,token:this.terminals_[m]||m,line:u.yylineno,loc:p,expected:E})}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+m);switch(w[0]){case 1:n.push(m),r.push(u.yytext),i.push(u.yylloc),n.push(w[1]),m=null,l=u.yyleng,a=u.yytext,s=u.yylineno,p=u.yylloc;break;case 2:if(_=this.productions_[w[1]][1],M.$=r[r.length-_],M._$={first_line:i[i.length-(_||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(_||1)].first_column,last_column:i[i.length-1].last_column},g&&(M._$.range=[i[i.length-(_||1)].range[0],i[i.length-1].range[1]]),void 0!==(x=this.performAction.apply(M,[a,l,s,f.yy,w[1],r,i].concat(d))))return x;_&&(n=n.slice(0,-1*_*2),r=r.slice(0,-1*_),i=i.slice(0,-1*_)),n.push(this.productions_[w[1]][0]),r.push(M.$),i.push(M._$),k=o[n[n.length-2]][n[n.length-1]],n.push(k);break;case 3:return!0}}return!0}},s=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(r=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((n=this._input.match(this.rules[i[o]]))&&(!t||n[0].length>t[0].length)){if(t=n,r=o,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,i[o])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[r]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,r){switch(n){case 0:return 12;case 1:return 8;case 2:return 13;case 3:return 14;case 4:return 6;case 5:return 5;case 6:return"INVALID"}},rules:[/^(?:\s*\|\s*)/,/^(?:(\\(\[|\]|\|)|[^\]\[|;\n])+)/,/^(?:\[)/,/^(?:\s*\])/,/^(?:[ ]*(;|\n)+[ ]*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6],inclusive:!0}}};return e}();function l(){this.yy={}}return a.lexer=s,l.prototype=a,a.Parser=l,new l}();function k(e){function t(e){return"#"!==e[0]&&"//"!==e.trim().substring(0,2)?e.trim():""}function n(e){return"#"===e.text[0]}var r=e.split("\n").map(((e,t)=>({text:e,index:t}))),i=r.filter(n),o={};i.forEach((e=>{try{var t=e.text.substring(1).split(":");o[t[0].trim()]=t[1].trim()}catch(t){throw new Error("line "+(e.index+1)+": Malformed directive")}}));var l=r.map((e=>t(e.text))).join("\n");return""==l?{root:new w([],[],[]),config:f(o)}:{root:S(E(l)),config:f(o)};function c(e){return"down"==e?"TB":"right"==e?"LR":"TB"}function h(e){return"network-simplex"==e||"tight-tree"==e||"longest-path"==e?e:"network-simplex"}function d(e){var t=s,n=e.replace(/[a-z]*=[^ ]+/g,""),r=a(e.match("title=([^ ]*)")||[""]),i=a(e.match("body=([^ ]*)")||[""]);return{title:{bold:t(r,"bold")||t(n,"bold"),underline:t(r,"underline")||t(n,"underline"),italic:t(r,"italic")||t(n,"italic"),center:!(t(r,"left")||t(e,"align=left"))},body:{bold:t(i,"bold"),underline:t(i,"underline"),italic:t(i,"italic"),center:t(i,"center")},dashed:t(e,"dashed"),fill:a(e.match("fill=([^ ]*)")||[]),stroke:a(e.match("stroke=([^ ]*)")||[]),visual:a(e.match("visual=([^ ]*)")||[])||"class",direction:c(a(e.match("direction=([^ ]*)")||[]))}}function f(e){var t,n={};for(var r in e)if("."==r[0]){var i=e[r];n[r.substring(1).toUpperCase()]=d(i)}return{arrowSize:+e.arrowSize||1,bendSize:+e.bendSize||.3,direction:c(e.direction),gutter:+e.gutter||20,edgeMargin:+e.edgeMargin||0,gravity:+(null!==(t=e.gravity)&&void 0!==t?t:1),edges:"hard"==e.edges?"hard":"rounded",fill:(e.fill||"#eee8d5;#fdf6e3;#eee8d5;#fdf6e3").split(";"),background:e.background||"transparent",fillArrows:"true"===e.fillArrows,font:e.font||"Helvetica",fontSize:+e.fontSize||12,leading:+e.leading||1.25,lineWidth:+e.lineWidth||3,padding:+e.padding||8,spacing:+e.spacing||40,stroke:e.stroke||"#33322E",title:e.title||"",zoom:+e.zoom||1,acyclicer:"greedy"===e.acyclicer?"greedy":void 0,ranker:h(e.ranker),styles:Object.assign(Object.assign({},u),n)}}}function E(e){return _.parse(e)}function S(e){function t(e){return void 0!==e.parts}function n(e){return void 0!==e.assoc}var r=0;function i(e){var i=[],a=[],s=[];e.forEach((e=>{"string"==typeof e&&i.push(e),n(e)&&(a.push(e.start),a.push(e.end),s.push({id:r++,assoc:e.assoc,start:e.start.parts[0][0],end:e.end.parts[0][0],startLabel:{text:e.startLabel},endLabel:{text:e.endLabel}})),t(e)&&a.push(e)}));var l=a.map(o).sort(((e,t)=>t.compartments.length-e.compartments.length)),h=c(l,"name"),d=s.filter((e=>{for(var t of s){if(e===t)return!0;if(t.start==e.start&&t.end==e.end)return!1}return!0}));return new w(i,h,d)}function o(e){var t=e.parts.map(i);return new b(e.type,e.id,t)}return i(e)}function N(e,t){return{x:e.x+t.x,y:e.y+t.y}}function z(e,t){return{x:e.x-t.x,y:e.y-t.y}}function L(e,t){return{x:t*e.x,y:t*e.y}}function T(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function I(e){return L(e,1/T(e))}function C(e){return{x:e.y,y:-e.x}}const O=!1,j=!0;function A(e,t){var n=t.path.slice(1,-1),r=I(z(n[n.length-2],a(n))),i=I(z(n[1],n[0])),o=e.spacing*e.arrowSize/30,s=0,l=n.length-1,c=n.map((e=>({x:e.x,y:e.y}))),h=t.assoc.split(/[-_]/);return c[s]=N(c[s],L(i,o*P(h[0]))),c[l]=N(c[l],L(r,o*P(a(h)))),c}function P(e){return">"===e||"<"===e?5:":>"===e||"<:"===e?10:"+"===e||"o"===e?14:"("===e||")"===e||"(o"===e||"o)"===e?11:">o"===e||"o<"===e?15:0}function R(e,t,n){var i=n.path[1],o=n.path[n.path.length-2],s=n.path.slice(1,-1),l=n.assoc.split(/[-_]/);function c(e,n,r){var i=I(z(n[n.length-2],a(n))),o=t.spacing*t.arrowSize/30;">"===e||"<"===e?f(i,o,j,r):":>"===e||"<:"===e?f(i,o,O,r):"+"===e?v(i,o,j,r):"o"===e?v(i,o,O,r):"("===e||")"===e?(u(i,o,11,r),d(i,o,5,r)):"(o"===e||"o)"===e?(u(i,o,11,r),d(i,o,5,r),h(i,o,11,r)):">o"!==e&&"o<"!==e||(f(i,.75*o,O,N(r,L(i,10*o))),d(i,o,8,r),h(i,o,8,r))}function h(n,r,i,o){var a=N(o,L(n,r*i));e.fillStyle(t.fill[0]),e.ellipse(a,6*r,6*r).fillAndStroke()}function d(t,n,r,i){var o=N(i,L(t,n*r));e.path([o,i]).stroke()}function u(t,n,i,o){var a=N(o,L(t,n*i)),s=C(t),l=r([-Math.PI/2,Math.PI/2],12).map((e=>N(a,N(L(t,-6*n*Math.cos(e)),L(s,6*n*Math.sin(e))))));e.path(l).stroke()}function f(n,r,i,o){const a=e=>N(o,L(n,e*r)),s=e=>L(C(n),e*r);var l=[N(a(10),s(4)),a(i&&!t.fillArrows?5:10),N(a(10),s(-4)),o];e.fillStyle(i?t.stroke:t.fill[0]),e.circuit(l).fillAndStroke()}function v(n,r,i,o){const a=e=>N(o,L(n,e*r)),s=e=>L(C(n),e*r);var l=[N(a(7),s(4)),a(14),N(a(7),s(-4)),o];e.save(),e.fillStyle(i?t.stroke:t.fill[0]),e.circuit(l).fillAndStroke(),e.restore()}c(a(l),s,o),c(l[0],s.reverse(),i)}function D(e,t,n){var r=e;function i(e,n,i,a){r.save(),r.translate(e.offset.x,e.offset.y),r.fillStyle(n||t.stroke),e.lines.forEach(((n,o)=>{r.textAlign(i.center?"center":"left");var a=i.center?e.width/2-t.padding:0,s=(.5+(o+.5)*t.leading)*t.fontSize;if(n&&r.fillText(n,a,s),i.underline){var l=r.measureText(n).width;s+=Math.round(.2*t.fontSize)+.5,i.center?r.path([{x:a-l/2,y:s},{x:a+l/2,y:s}]).stroke():r.path([{x:a,y:s},{x:a+l,y:s}]).stroke(),r.lineWidth(t.lineWidth)}})),r.save(),r.translate(t.gutter,t.gutter),e.relations.forEach((e=>h(e))),e.nodes.forEach((e=>o(e,a))),r.restore(),r.restore()}function o(e,n){var o=Math.round(e.x-e.width/2),s=Math.round(e.y-e.height/2),l=t.styles[e.type]||u.CLASS;if(r.save(),r.setData("name",e.name),r.save(),r.fillStyle(l.fill||t.fill[n]||a(t.fill)),r.strokeStyle(l.stroke||t.stroke),l.dashed){var c=Math.max(4,2*t.lineWidth);r.setLineDash([c,c])}var h=m[l.visual]||m.class;for(var d of(h(e,o,s,t,r),e.dividers))r.path(d.map((e=>N(e,{x:o,y:s})))).stroke();r.restore(),e.compartments.forEach(((e,a)=>{var c=0==a?l.title:l.body;r.save(),r.translate(o+e.x,s+e.y),r.setFont(t.font,t.fontSize,c.bold?"bold":"normal",c.italic?"italic":"normal"),i(e,l.stroke,c,n+1),r.restore()})),r.restore()}function l(e){if("rounded"===t.edges){var n=t.spacing*t.bendSize;r.beginPath(),r.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length-1;i++)r.arcTo(e[i].x,e[i].y,e[i+1].x,e[i+1].y,n);r.lineTo(a(e).x,a(e).y),r.stroke()}else r.path(e).stroke()}function c(e){if(e&&e.text){var n=t.fontSize;e.text.split("`").forEach(((t,i)=>r.fillText(t,e.x,e.y+n*(i+1))))}}function h(e){var n=A(t,e);if(r.fillStyle(t.stroke),r.setFont(t.font,t.fontSize,"normal","normal"),c(e.startLabel),c(e.endLabel),"-/-"!==e.assoc&&"_/_"!==e.assoc)if(s(e.assoc,"--")||s(e.assoc,"__")){var i=Math.max(4,2*t.lineWidth);r.save(),r.setLineDash([i,i]),l(n),r.restore()}else l(n);R(r,t,e)}function f(){t.lineWidth%2==1&&r.translate(.5,.5)}function v(){r.clear(),r.save(),r.strokeStyle("transparent"),r.fillStyle(t.background),r.rect(0,0,n.width,n.height).fill(),r.restore()}r.save(),r.scale(t.zoom,t.zoom),f(),v(),r.setFont(t.font,t.fontSize,"bold","normal"),r.lineWidth(t.lineWidth),r.lineJoin("round"),r.lineCap("round"),r.strokeStyle(t.stroke),i(n,void 0,d({},{}).title,0),r.restore()}function F(e,t){var n=e.getContext("2d"),r={x:0,y:0},i=6.2832;function o(t){var n=e;return{x:t.clientX-n.getBoundingClientRect().left-n.clientLeft+n.scrollLeft,y:t.clientY-n.getBoundingClientRect().top-n.clientTop+n.scrollTop}}t&&(e.addEventListener("mousedown",(function(e){t.mousedown&&t.mousedown(o(e))})),e.addEventListener("mouseup",(function(e){t.mouseup&&t.mouseup(o(e))})),e.addEventListener("mousemove",(function(e){r=o(e),t.mousemove&&t.mousemove(o(e))})));var a={stroke:function(){return n.stroke(),a},fill:function(){return n.fill(),a},fillAndStroke:function(){return n.fill(),n.stroke(),a}};function s(e,t,r){r=void 0===r?1:r,t=t||{x:0,y:0},n.beginPath(),n.moveTo(t.x+r*e[0].x,t.y+r*e[0].y);for(var i=1,o=e.length;i<o;i++)n.lineTo(t.x+r*e[i].x,t.y+r*e[i].y);return a}return{mousePos:function(){return r},width:function(){return e.width},height:function(){return e.height},clear:function(){n.clearRect(0,0,e.width,e.height)},circle:function(e,t){return n.beginPath(),n.arc(e.x,e.y,t,0,i),a},ellipse:function(e,t,r,o,s){return void 0===o&&(o=0),void 0===s&&(s=i),n.beginPath(),n.save(),n.translate(e.x,e.y),n.scale(1,r/t),n.arc(0,0,t/2,o,s),n.restore(),a},arc:function(e,t,r,i,o){return n.beginPath(),n.moveTo(e,t),n.arc(e,t,r,i,o),a},roundRect:function(e,t,r,i,o){return n.beginPath(),n.moveTo(e+o,t),n.arcTo(e+r,t,e+r,t+o,o),n.lineTo(e+r,t+i-o),n.arcTo(e+r,t+i,e+r-o,t+i,o),n.lineTo(e+o,t+i),n.arcTo(e,t+i,e,t+i-o,o),n.lineTo(e,t+o),n.arcTo(e,t,e+o,t,o),n.closePath(),a},rect:function(e,t,r,i){return n.beginPath(),n.moveTo(e,t),n.lineTo(e+r,t),n.lineTo(e+r,t+i),n.lineTo(e,t+i),n.closePath(),a},path:s,circuit:function(e,t,r){return s(e,t,r),n.closePath(),a},setFont:function(e,t,r,i){n.font=`${r} ${i} ${t}pt ${e}, Helvetica, sans-serif`},fillStyle:function(e){n.fillStyle=e},strokeStyle:function(e){n.strokeStyle=e},textAlign:function(e){n.textAlign=e},lineCap:function(e){n.lineCap=e},lineJoin:function(e){n.lineJoin=e},lineWidth:function(e){n.lineWidth=e},arcTo:function(){return n.arcTo.apply(n,arguments)},beginPath:function(){return n.beginPath.apply(n,arguments)},fillText:function(){return n.fillText.apply(n,arguments)},lineTo:function(){return n.lineTo.apply(n,arguments)},measureText:function(){return n.measureText.apply(n,arguments)},moveTo:function(){return n.moveTo.apply(n,arguments)},restore:function(){return n.restore.apply(n,arguments)},setData:function(e,t){},save:function(){return n.save.apply(n,arguments)},scale:function(){return n.scale.apply(n,arguments)},setLineDash:function(){return n.setLineDash.apply(n,arguments)},stroke:function(){return n.stroke.apply(n,arguments)},translate:function(){return n.translate.apply(n,arguments)}}}function B(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>`${e}="${$(t)}"`)).join(" ")}function $(e){return"number"==typeof e?e.toFixed(1):(null!=e?e:"").toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}var q={0:10,1:10,2:10,3:10,4:10,5:10,6:10,7:10,8:10,9:10," ":5,"!":5,'"':6,"#":10,$:10,"%":15,"&":11,"'":4,"(":6,")":6,"*":7,"+":10,",":5,"-":6,".":5,"/":5,":":5,";":5,"<":10,"=":10,">":10,"?":10,"@":17,A:11,B:11,C:12,D:12,E:11,F:10,G:13,H:12,I:5,J:9,K:11,L:10,M:14,N:12,O:13,P:11,Q:13,R:12,S:11,T:10,U:12,V:11,W:16,X:11,Y:11,Z:10,"[":5,"\\":5,"]":5,"^":8,_:10,"`":6,a:10,b:10,c:9,d:10,e:10,f:5,g:10,h:10,i:4,j:4,k:9,l:4,m:14,n:10,o:10,p:10,q:10,r:6,s:9,t:5,u:10,v:9,w:12,x:9,y:9,z:9,"{":6,"|":5,"}":6,"~":10};function V(e){var t={stroke:void 0,"stroke-width":1,"stroke-dasharray":void 0,"stroke-linecap":void 0,"stroke-linejoin":void 0,"text-align":"left",font:"12pt Helvetica, Arial, sans-serif","font-size":"12pt"},n=e?e.createElement("canvas"):null,o=n?n.getContext("2d"):null;class s{constructor(e,t,n,r){this.elideEmpty=!1,this.name=e,this.attr=t,this.parent=n,this.children=[],this.text=r||void 0}stroke(){return this.attr.fill="none",this}fill(){return this.attr.stroke="none",this}fillAndStroke(){return this}group(){return this.parent}serialize(){var e;const t=null!==(e=l(this.group(),(e=>e.data)))&&void 0!==e?e:{},n=B(Object.assign(Object.assign({},this.attr),t)),r=this.children.map((e=>e.serialize())).join("\n");return this.text&&0===this.children.length?`<${this.name} ${n}>${$(this.text)}</${this.name}>`:0===this.children.length?this.elideEmpty?"":`<${this.name} ${n}></${this.name}>`:`<${this.name} ${n}>\n\t\t${r.replace(/\n/g,"\n\t")}\n\t</${this.name}>`}}function l(e,t){var n,r;return e&&null!==(r=null!==(n=t(e))&&void 0!==n?n:l(e.parent,t))&&void 0!==r?r:t(h)}class c extends s{constructor(e){super("g",{},e),this.elideEmpty=!0}group(){return this}}const h=new c({});h.attr=t;var d=new s("svg",{version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:ev":"http://www.w3.org/2001/xml-events"},void 0),u=new c(d);u.attr=t,d.children.push(u);var f=!1;function v(e,t={x:0,y:0},n=1){return p("path",{d:e.map(((e,r)=>(r?"L":"M")+(t.x+n*e.x).toFixed(1)+" "+(t.y+n*e.y).toFixed(1))).join(" ")})}function p(e,t,n){var r=new s(e,t,u,n);return u.children.push(r),r}return{width:function(){return 0},height:function(){return 0},clear:function(){},circle:function(e,t){return p("circle",{r:t,cx:e.x,cy:e.y})},ellipse:function(e,t,n,i=0,o=0){if(i||o){var a=r([i,o],64).map((r=>N(e,{x:Math.cos(r)*t/2,y:Math.sin(r)*n/2})));return v(a)}return p("ellipse",{cx:e.x,cy:e.y,rx:t/2,ry:n/2})},arc:function(e,t,n){return p("ellipse",{cx:e,cy:t,rx:n,ry:n})},roundRect:function(e,t,n,r,i){return p("rect",{x:e,y:t,rx:i,ry:i,height:r,width:n})},rect:function(e,t,n,r){return p("rect",{x:e,y:t,height:r,width:n})},path:v,circuit:function(e,t,n){var r=v(e,t,n);return r.attr.d+=" Z",r},setFont:function(e,t,n,r){u.attr["font-family"]=e,u.attr["font-size"]=t+"pt",u.attr["font-weight"]=n,u.attr["font-style"]=r},strokeStyle:function(e){u.attr.stroke=e},fillStyle:function(e){u.attr.fill=e},arcTo:function(e,t,n,r){if(!f)throw new Error("can only be called after .beginPath()");a(u.children).attr.d+="L"+e+" "+t+" L"+n+" "+r+" "},beginPath:function(){return f=!0,p("path",{d:""})},fillText:function(e,t,n){return p("text",{x:t,y:n,stroke:"none",font:void 0,style:void 0,"text-anchor":"center"===l(u,(e=>e.attr["text-align"]))?"middle":void 0},e)},lineCap:function(e){u.attr["stroke-linecap"]=e},lineJoin:function(e){u.attr["stroke-linejoin"]=e},lineTo:function(e,t){if(!f)throw new Error("can only be called after .beginPath()");return a(u.children).attr.d+="L"+e.toFixed(1)+" "+t.toFixed(1)+" ",u},lineWidth:function(e){u.attr["stroke-width"]=e},measureText:function(e){return o?(o.font=u?`${l(u,(e=>e.attr["font-weight"]))} ${l(u,(e=>e.attr["font-style"]))} ${l(u,(e=>e.attr["font-size"]))} ${l(u,(e=>e.attr["font-family"]))}`:`${t["font-weight"]} ${t["font-style"]} ${t["font-size"]} ${t["font-family"]}`,o.measureText(e)):{width:i(e,(function(e){var t,n;const r=null!==(t=l(u,(e=>e.attr["font-size"])))&&void 0!==t?t:12;var i=parseInt(r.toString())/12;return(null!==(n=q[e])&&void 0!==n?n:16)*i}))}},moveTo:function(e,t){if(!f)throw new Error("can only be called after .beginPath()");a(u.children).attr.d+="M"+e.toFixed(1)+" "+t.toFixed(1)+" "},restore:function(){u.parent&&(u=u.parent)},save:function(){var e=new c(u);u.children.push(e),u=e},setData:function(e,t){var n;u.data=null!==(n=u.data)&&void 0!==n?n:{},u.data["data-"+e]=t},scale:function(){},setLineDash:function(e){u.attr["stroke-dasharray"]=0===e.length?"none":e[0]+" "+e[1]},stroke:function(){f=!1,a(u.children).stroke()},textAlign:function(e){u.attr["text-align"]=e},translate:function(e,t){if(Number.isNaN(e)||Number.isNaN(t))throw new Error("dx and dy must be real numbers");u.attr.transform=`translate(${e}, ${t})`},serialize:function(e,t,n){return t&&d.children.unshift(new s("desc",{},void 0,t)),n&&d.children.unshift(new s("title",{},void 0,n)),d.attr={version:"1.1",baseProfile:"full",width:e.width,height:e.height,viewbox:"0 0 "+e.width+" "+e.height,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:ev":"http://www.w3.org/2001/xml-events"},d.serialize()}}}function G(e,t,n){e.width=t.width*n,e.height=t.height*n}function W(e,t){return{setFont(e,n,r,i){t.setFont(e,n,r,i)},textWidth:e=>t.measureText(e).width,textHeight:()=>e.leading*e.fontSize}}function H(e,t,n,r){var i=k(e),o=i.config,a=y(W(o,t),o,i.root);return n&&G(n,a,o.zoom*r),o.zoom*=r,D(t,o,a),{config:o,layout:a}}function U(e,t,n){return H(t,F(e),e,n||1)}function Y(e,t){var n=V(t),{config:r,layout:i}=H(e,n,null,1);return n.serialize({width:i.width,height:i.height},e,r.title)}class J extends Error{constructor(){super("max_import_depth exceeded")}}function K(e,t,r=10){return n(this,void 0,void 0,(function*(){if(-1==r)throw new J;function i(e){return n(this,void 0,void 0,(function*(){try{return(yield t(e))||""}catch(e){return""}}))}var o=[];e.replace(/#import: *(.*)/g,((e,n)=>{var a=i(n).then((e=>K(e,t,r-1)));return o.push({file:n,promise:a}),""}));var a={};for(var s of o)a[s.file]=yield s.promise;return e.replace(/#import: *(.*)/g,((e,t)=>a[t]))}))}function Q(e,t,n=10){if(-1==n)throw new J;function r(e){try{return t(e)||""}catch(e){return""}}return e.replace(/#import: *(.*)/g,((e,i)=>Q(r(i),t,n-1)))}function X(e,t){var n=M,r=M,i=r.dirname(e);function o(e){return n.readFileSync(r.join(i,e),{encoding:"utf8"})}return Q(o(e.substr(i.length)),o,t)}var Z="1.5.3";e.Classifier=b,e.Compartment=w,e.ImportDepthError=J,e.Relation=x,e.compileFile=X,e.draw=U,e.intermediateParse=E,e.layout=y,e.parse=k,e.processAsyncImports=K,e.processImports=Q,e.renderSvg=Y,e.skanaar=h,e.styles=u,e.transformParseIntoSyntaxTree=S,e.version=Z,e.visualizers=m,Object.defineProperty(e,"__esModule",{value:!0})}(t,(x||(x=1,function(e){e.exports=S()}(k)),k.exports))}(0,_.exports);var N=a({__proto__:null,default:g(_.exports)},[_.exports]);class z{constructor(e){this.canvasElement=e,this.filename="graph",this.source=""}pngDownload(){var e=this.canvasElement;e.msToBlob?b(e.msToBlob(),this.filename+".png"):this.canvasElement.toBlob((e=>b(e,this.filename+".png")))}svgDownload(){var e=_.exports.renderSvg(this.source,document);b(new Blob([e],{type:"image/svg+xml"}),this.filename+".svg")}srcDownload(){var e=this.source;b(new Blob([e],{type:"text/txt"}),this.filename+".nomnoml")}setFilename(e){e=e||"nomnoml",this.filename=e.replace(/[^ a-zA-Z0-9_-]/g,"_")}}class L{constructor(){this.callbacks={}}on(e,t){this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t)}off(e,t){var n=this.callbacks[e];if(n){var r=n.indexOf(t);-1!==r&&n.splice(r,1),0===n.length&&delete this.callbacks[e]}}trigger(e,...t){var n=this.callbacks[e];n&&n.forEach((e=>e.apply(null,t)))}}class T{constructor(e,t){this.context=e,this.path=t}static from(e){var t=e.indexOf("/");return"#"==e[0]&&t>-1?{context:T.urlDecode(e.substr(1,t-1)),path:T.urlDecode(e.substr(t+1))}:{context:"",path:""}}static urlEncode(e){return encodeURIComponent(e).replace(/'/g,"%27").replace(/"/g,"%22")}static urlDecode(e){return decodeURIComponent(e.replace(/\+/g," "))}}function I(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}class C{constructor(){this.signals=new L,this.activeFile={name:"",date:"1970-01-01",backingStore:"url"},this.storage=new j}finishedInsertingFiles(){this.signals.trigger("updated")}async moveToFileStorage(e,t){new P(e).insert(t),this.signals.trigger("updated")}async moveToLocalStorage(e){this.storage=new j,await this.storage.save(e)}async discard(e){var t=new P(e.name);await t.clear(),this.signals.trigger("updated")}async configureByRoute(e){var t=T.from(e);this.storage=this.routedStorage(t);var n=await this.storage.files();this.activeFile=I(n,(e=>e.name===t.path))||O(t.path,"local_file"),this.signals.trigger("updated")}routedStorage(e){return"view"===e.context?new A(decodeURIComponent(e.path)):"file"===e.context?new P(e.path):new j}}function O(e,t){return{date:(new Date).toISOString(),name:e,backingStore:t}}class j{constructor(){this.kind="local_default",this.storageKey="nomnoml.lastSource"}async files(){return JSON.parse(localStorage["nomnoml.file_index"]||"[]")}async read(){return localStorage[this.storageKey]}async insert(e){}async save(e){localStorage[this.storageKey]=e}async clear(){}}class A{constructor(e){this.source=e,this.kind="url"}async files(){return JSON.parse(localStorage["nomnoml.file_index"]||"[]")}async read(){return this.source}async insert(e){}async save(e){}async clear(){}}class P{constructor(e){this.name=e,this.kind="local_file",this.storageKey="nomnoml.files/"+e}async files(){return JSON.parse(localStorage["nomnoml.file_index"]||"[]")}async read(){return localStorage[this.storageKey]}async insert(e){var t=O(this.name,"local_file"),n=await this.files();I(n,(e=>e.name===this.name))||(n.push(t),n.sort(((e,t)=>e.name.localeCompare(t.name))),localStorage["nomnoml.file_index"]=JSON.stringify(n)),localStorage[this.storageKey]=e}async save(e){localStorage[this.storageKey]=e}async clear(){localStorage.removeItem(this.storageKey);var e=(await this.files()).filter((e=>e.name!=this.name));localStorage["nomnoml.file_index"]=JSON.stringify(e)}}class R{constructor(e,t,n){function r(n){return function(){n?t.classList.add(e):t.classList.remove(e)}}for(var i of n)i.addEventListener("mouseenter",r(!0)),i.addEventListener("mouseleave",r(!1))}}class D{constructor(e){this.dynamicButton=null,this.signals=new L,this.on=this.signals.on,this.off=this.signals.off;var t=document.querySelector("body"),n=document.getElementById("linenumbers"),r=document.getElementById("linemarker"),i=document.getElementById("textarea"),o=document.getElementById("canvas"),a=document.getElementById("canvas-panner");this.editor=e.fromTextArea(i,{lineNumbers:!0,mode:"nomnoml",matchBrackets:!0,theme:"solarized light",keyMap:"sublime"}),this.editor.on("drop",((e,t)=>{var n=t.dataTransfer?.files;n&&"image/svg+xml"==n[0].type&&(t.preventDefault(),this.handleOpeningFiles(n))}));var s=this.editor.getWrapperElement();this.filesystem=new C;var l=new v(s,r,n);this.panner=new f(a,(()=>this.sourceChanged())),this.downloader=new z(o),new R("canvas-mode",t,[a]),this.defaultSource=(document.getElementById("defaultGraph")||{innerHTML:""}).innerHTML;var c=null,u=async()=>{c=null,await this.filesystem.configureByRoute(location.hash);try{var e=await this.filesystem.storage.read();this.editor.setValue(e||this.defaultSource),this.sourceChanged()}catch(e){console.log(e)}};async function p(e){var t=new P(e);return await t.read()??""}window.addEventListener("hashchange",(()=>u())),window.addEventListener("resize",h((()=>this.sourceChanged()),750,{leading:!0})),this.editor.on("changes",d((()=>this.sourceChanged()),300)),this.sourceChanged=async()=>{try{this.signals.trigger("compile-error",null),l.clearState();var e=this.editor.getValue(),t=await function(e){try{return _.exports.processAsyncImports(e,p)}catch(e){if(e instanceof _.exports.ImportDepthError)return"Error: too many imports";throw e}}(e),n=_.exports.draw(o,t,this.panner.zoom());c=e,this.panner.positionCanvas(o),this.filesystem.storage.save(e),this.downloader.source=e,this.downloader.setFilename(n.config.title||this.filesystem.activeFile.name),this.signals.trigger("source-changed",e)}catch(e){this.signals.trigger("compile-error",e),c&&_.exports.draw(o,c,this.panner.zoom()),this.panner.positionCanvas(o),l.setError(e)}},u()}loadSvg(e){var t=(new DOMParser).parseFromString(e,"text/xml");if(1===t.getElementsByTagName("desc").length){var n=t.getElementsByTagName("desc")[0].childNodes[0].nodeValue;n=c(n||""),this.editor.setValue(n)}else alert("SVG did not have nomnoml code embedded within it.")}currentSource(){return this.editor.getValue()}magnifyViewport(e){this.panner.magnify(e)}resetViewport(){this.panner.reset()}toggleSidebar(e){for(var t of["about","reference","export","files"])e!==t&&document.getElementById(t)?.classList.remove("visible");document.getElementById(e)?.classList.toggle("visible")}discardCurrentGraph(){confirm("Do you want to discard current diagram and load the default example?")&&(this.editor.setValue(this.defaultSource),this.sourceChanged())}async saveAs(e=""){var t=prompt("Name your diagram",e)??e,n=this.currentSource();return t?this.filesystem.storage.files().then((e=>e.some((e=>e.name===t))?(alert("A file named "+t+" already exists."),"failure"):(this.filesystem.moveToFileStorage(t,n),location.href="#file/"+encodeURIComponent(t),"success"))):"failure"}exitViewMode(){window.location.href="./"}handleOpeningFiles(e){if(1===e.length){var t=new FileReader;t.onload=()=>this.loadSvg(t.result),t.readAsText(e[0])}else alert("You can only upload one file at a time.")}}var F=n.createElement,B=(...e)=>F("div",...e),$=(...e)=>F("span",...e),q=(...e)=>F("h2",...e),V=(...e)=>F("label",...e),G=(...e)=>F("a",...e),W=(...e)=>F("input",...e);function H(e){return function(t){t.preventDefault(),e(t)}}function U(e){return F("i",{className:"icon"},F("svg",{version:"1.2",baseProfile:"tiny",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},F("path",{d:e.shape})))}var Y="M12 4.5l-4.7 4.7c-.3.3-.3 1.0 0 1.4s1.0.3 1.4 0l2.2-2.2v7.5c0 .5.4 1 1 1s1-.4 1-1v-7.5l2.2 2.2c.1.1.4.2.7.2s.5-.0.7-.2c.3-.3.3-1.0 0-1.4l-4.7-4.7z M19 18c.55 0 1 .45 1 1s-.45 1-1 1h-14c-.55 0-1-.45-1-1s.45-1 1-1h14m0-2h-14c-1.6 0-3 1.3-3 3s1.3 3 3 3h14c1.6 0 3-1.3 3-3s-1.3-3-3-3z",J="M18 7h-1v-1c0-1.1-.8-2-2-2h-7c-1.1 0-2 .8-2 2v1h-1c-.5 0-1 .4-1 1s.4 1 1 1v8c0 2.2 1.7 4 4 4h5c2.2 0 4-1.7 4-4v-8c.5 0 1-.4 1-1s-.4-1-1-1zm-10-1h7v1h-7v-1zm8 11c0 1.1-.8 2-2 2h-5c-1.1 0-2-.8-2-2v-8h9v8zM8.5 10.5c-.2 0-.5.2-.5.5v6c0 .2.2.5.5.5s.5-.2.5-.5v-6c0-.2-.2-.5-.5-.5zM10.5 10.5c-.2 0-.5.2-.5.5v6c0 .2.2.5.5.5s.5-.2.5-.5v-6c0-.2-.2-.5-.5-.5zM12.5 10.5c-.2 0-.5.2-.5.5v6c0 .2.2.5.5.5s.5-.2.5-.5v-6c0-.2-.2-.5-.5-.5zM14.5 10.5c-.2 0-.5.2-.5.5v6c0 .2.2.5.5.5s.5-.2.5-.5v-6c0-.2-.2-.5-.5-.5z",K="M8.5 7.9c.8 0 1.5.6 1.5 1.5s-.6 1.5-1.5 1.5-1.5-.6-1.5-1.5.6-1.5 1.5-1.5m0-1c-1.3 0-2.5 1.1-2.5 2.5s1.1 2.5 2.5 2.5 2.5-1.1 2.5-2.5-1.1-2.5-2.5-2.5zM16 11.9c.45.0 1.27 1.8 1.7 4.0h-11.3c.4-1.0 1.0-2.0 1.6-2.0.8 0 1.1.1 1.53.42.4.2 1.0.58 1.97.58 1.1 0 1.9-.8 2.6-1.6.6-.6 1.2-1.3 1.8-1.3m0-1c-2 0-3 3-4.5 3s-1.4-1-3.5-1c-2 0-3.0 4-3.0 4h14.0s-1-6-3-6zM22 6c0-1.1-.8-2-2-2h-16c-1.1 0-2 .8-2 2v12c0 1.1.8 2 2 2h16c1.1 0 2-.8 2-2v-12zm-2 12h-16v-12h16.0l-.0 12z";function Q(e){return B({className:"canvas-tools"},B({className:"canvas-button"},G({title:"Zoom in",onClick:H((()=>e.app.magnifyViewport(2)))},F(U,{shape:"M18 10h-4v-4c0-1.1-.8-2-2-2s-2 .8-2 2l.0 4h-4.0c-1.1 0-2 .8-2 2s.8 2 2 2l4.0-.0-.0 4.0c0 1.1.8 2 2 2s2-.8 2-2v-4.0l4 .0c1.1 0 2-.8 2-2s-.8-2-2-2z"}))),B({className:"canvas-button"},G({title:"Reset zoom and panning",onClick:H((()=>e.app.resetViewport()))},F(U,{shape:"M18 7h-12c-1.1 0-2 .8-2 2s.8 2 2 2h12c1.1 0 2-.8 2-2s-.8-2-2-2zM18 14h-12c-1.1 0-2 .8-2 2s.8 2 2 2h12c1.1 0 2-.8 2-2s-.8-2-2-2z"}))),B({className:"canvas-button"},G({title:"Zoom out",onClick:H((()=>e.app.magnifyViewport(-2)))},F(U,{shape:"M18 11h-12c-1.1 0-2 .8-2 2s.8 2 2 2h12c1.1 0 2-.8 2-2s-.8-2-2-2z"}))))}function X(e){var t=e.app.downloader,n=e.app.downloader.source;return B({className:"file-menu"},q({},"Share diagram"),G({className:"btn",href:"#view/"+T.urlEncode(n),target:"_blank"},F(U,{shape:"M17.5 6c.3 0 .6.1.8.3.4.5.4 1.1 0 1.6l-1.7 1.7.3.3c.5.6.9 1.4.9 2.2s-.4 1.6-1 2.2l-4.1 4.2c-.6.5-1.4.9-2.2.9s-1.6-.4-2.2-1l-.3-.2-1.7 1.7a1 1 0 0 1-1.6 0c-.4-.5-.4-1.1 0-1.6l1.7-1.7-.3-.3c-.5-.6-.9-1.4-.9-2.2s.4-1.6 1-2.2l4.1-4.2c.6-.5 1.4-.8 2.2-.8s1.6.3 2.2.8l.3.3 1.7-1.7c.2-.2.5-.3.8-.3m0-2a3 3 0 0 0-2.2 1l-.5.4a5.2 5.2 0 0 0-5.9 1l-4.2 4a5 5 0 0 0-1 6l-.4.5a3 3 0 0 0 0 4.4 3 3 0 0 0 4.4 0l.5-.5a5 5 0 0 0 5.9-1l4.2-4a5 5 0 0 0 1-6l.4-.5a3 3 0 0 0 0-4.4 3 3 0 0 0-2.2-.9zm-6.1 7.2a2 2 0 0 0 2 2L11.6 15a2 2 0 0 0-2-2l1.8-1.8M12.5 9c-.2 0-.5.1-.6.3l-4.2 4.2c-.2.1-.3.4-.3.6 0 .2.1.5.3.6l.3.3.7-.7a1 1 0 0 1 1.6 0c.4.5.4 1.1 0 1.6l-.7.7.3.3c.1.2.4.3.6.3l.6-.3 4.2-4.2c.2-.1.3-.4.3-.6 0-.2-.1-.5-.3-.6l-.3-.3-.7.7a1 1 0 0 1-1.6 0c-.4-.5-.4-1.1 0-1.6l.7-.7-.3-.3a.9.9 0 0 0-.6-.3z"}),"Shareable link"),G({className:"btn",href:"image.svg?source="+T.urlEncode(n),target:"_blank"},F(U,{shape:"M12.1 3.3q2.6 0 4.8 1.3Q19 6 20.3 8.1q1.2 2.1 1.2 4.7t-1.3 4.7Q19 19.7 16.8 21q-2.2 1.3-4.7 1.3-2.6 0-4.8-1.3-2.1-1.3-3.4-3.4-1.2-2.2-1.2-4.7Q2.7 10 4 8q1.2-2.2 3.4-3.4 2.2-1.3 4.7-1.3zm-.7 2.2Q10 6 9.2 8.3q1 .3 2.2.4V5.5zm1.4 3.2q1.1 0 2.2-.4-.7-2.3-2.2-2.8v3.2zm2.6-2.6q.6.9.9 1.8l1-.5q-.8-.7-1.9-1.3zM8 8l.9-1.8q-1 .5-1.8 1.3L8 8zm11.5 4.2q0-2-1.3-3.7-.8.6-1.5.8.3 1.4.4 2.9h2.4zm-11.9-3Q6.9 9 6 8.4 5 10 4.7 12.1h2.5q0-1.5.4-2.9zm3.8.9l-2.6-.5q-.2 1.1-.2 2.5h2.8V10zm4.2 2q0-1.4-.2-2.5l-2.6.5v2h2.8zM4.7 13.4q.3 2 1.4 3.7l1.5-.8q-.3-1.4-.4-2.9H4.7zm3.9 0q0 1.4.2 2.5l2.6-.5v-2H8.6zm4.2 2l2.6.5q.2-1.1.2-2.5h-2.8v2zm3.8.9q.7.2 1.5.8 1.1-1.6 1.3-3.7H17q0 1.5-.4 2.9zM12.8 20q1.5-.5 2.2-2.8l-2.2-.4V20zm-1.4-3.2q-1.1 0-2.2.4.7 2.3 2.2 2.8v-3.2zm-3.5.8L7 18l1.8 1.2-.8-1.7zm8.4 0q-.3 1-.9 1.7 1-.4 1.8-1.2l-1-.5z"}),"Server hosted SVG"),q({},"Downloads"),G({className:"btn",href:"/",onClick:H((()=>t.pngDownload()))},F(U,{shape:"M19 20h-14c-1.6 0-3-1.3-3-3v-8c0-1.6 1.3-3 3-3h1.5l1-1c.5-.5 1.5-1 2.4-1h4c.8 0 1.8.4 2.4 1l1 1h1.5c1.6 0 3 1.3 3 3v8c0 1.6-1.3 3-3 3zm-14-12c-.5 0-1 .4-1 1v8c0 .5.4 1 1 1h14c.5 0 1-.4 1-1v-8c0-.5-.4-1-1-1h-2c-.2 0-.52-.1-.7-.2l-1.2-1.2c-.2-.2-.7-.4-1-.4h-4c-.2 0-.7.2-1 .4l-1.2 1.2c-.1.1-.4.2-.7.2h-2zM12 10c1.3 0 2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5-2.5-1.1-2.5-2.5 1.1-2.5 2.5-2.5m0-1c-1.9 0-3.5 1.5-3.5 3.5 0 1.9 1.5 3.5 3.5 3.5s3.5-1.5 3.5-3.5c0-1.9-1.5-3.5-3.5-3.5zM18 8.6c-.7 0-1.3.5-1.3 1.3s.5 1.2 1.3 1.2 1.3-.58 1.3-1.2-.5-1.3-1.3-1.3z"}),"PNG image"),F("p",{},"Downloaded image files will be given the filename in the ",F("tt",{},"#title")," directive"),G({className:"btn",href:"/",onClick:H((()=>t.svgDownload()))},F(U,{shape:K}),"SVG with source"),F("p",{},"Downloaded SVG files will have the source code embedded. Open an exported SVG file to load it's nomnoml source."),G({className:"btn",href:"/",onClick:H((()=>t.srcDownload()))},F(U,{shape:"M20.9 17c0-.1-.0-.2-.0-.3l-2-6c-.1-.4-.5-.6-.9-.6h-.5l.6-.6c1.17-1.17 1.17-3.0 0-4.2-.81-.8-2.0-1.0-3.1-.7v-1.3c0-1.6-1.3-3-3-3s-3 1.3-3 3v1.3c-1.0-.3-2.3-.1-3.1.7-1.17 1.17-1.17 3.0.0 4.2l.68.6h-.5c-.4 0-.8.2-.9.6l-2 6c-.0.1-.0.2-.0.3-.0 0-.0 5-.0 5 0 .5.4 1 1 1h16c.5 0 1-.4 1-1 0 0 0-5-.0-5zm-13.6-10.5c.1-.1.4-.2.7-.2s.5.1.7.2l2.2 2.2v-5.7c0-.5.4-1 1-1s1 .4 1 1v5.7l2.2-2.2c.3-.3 1.0-.3 1.4 0 .3.39.3 1.0.0 1.4l-4.7 4.6-4.7-4.6c-.3-.3-.3-1.0 0-1.4zm-.5 5.5h1.8l3.4 3.41 3.4-3.41h1.8l1.6 5h-13.8l1.6-5zm12.2 9h-14v-3h14v3z"}),"Source code"))}function Z(e){var t=e.app.filesystem,n="local_file"===t.storage.kind,r="local_default"===t.storage.kind,i=[],o=null;for(var a of e.files){var s=a.name.split("/"),c=s.pop(),h=s.join("/");o!=h&&""!==h&&(o=h,i.push({isDir:!0,name:h})),i.push({isDir:!1,name:c,entry:a})}function d(e){return n&&t.activeFile.name===e.name}async function u(e){var n=new l.default,r=await t.storage.files();for(var i of r)if(!e||i.name.startsWith(e+"/")){var o=new P(i.name);n.file(i.name,await o.read())}var a=await n.generateAsync({type:"blob"}),s=(new Date).toISOString().substr(0,10);b(a,e??`nomnoml-${s}.zip`)}function f(e,t){for(var n="";t.some((t=>t==e+n));)n=""==n?2:n+1;return e+n.toString()}function v(n,r){var i,o=d(r)?"active ":"",a=n===r.name?"":"indented";return B({key:r.name,className:"file-entry "+o+a},G({href:(i=r,"#file/"+encodeURIComponent(i.name).replace(/%20/g,"+").replace(/%2F/g,"/"))},n),d(r)&&G({onClick:H((()=>async function(n){"success"==await e.app.saveAs(n.name)&&t.discard(n)}(r))),title:"Rename this diagram"},F(U,{shape:"M21 6.8l-3.8-3.8c-.2-.2-.6-.4-1.0-.4-.3 0-.7.1-1.06.4l-10.9 10.9c-.2.2-.5.7-.75 1.1-.1.4-.3.9-.3 1.3v4.5h4.5c.4 0 .9-.1 1.3-.3.4-.1.8-.4 1.1-.75l10.94-10.9c.2-.2.4-.6.4-1.0 0-.3-.1-.7-.4-1.06zm-15.2 8.1l8.2-8.2 1.2 1.2-8.2 8.2-1.2-1.2zm1.7 3.9h-1.5l-1-1v-1.5c0-.0.0-.3.1-.6.01-.02 2.9 2.9 2.9 2.9-.3.1-.5.1-.6.1zm1.4-.7l-1.2-1.2 8.2-8.2 1.2 1.2-8.2 8.2zm9-9l-3.1-3.1 1.2-1.2 3.17 3.1-1.2 1.2z"})),G({onClick:H((()=>function(e){confirm('Permanently delete "'+e.name+'"')&&t.discard(e)}(r))),title:"Discard this diagram"},F(U,{shape:J})))}return B({className:"file-menu"},V({className:"btn"},F(U,{shape:K}),"Open SVG with source...",W({type:"file",accept:"image/svg+xml",onChange:H((function(t){var n=t.target.files;e.app.handleOpeningFiles(n)}))})),G({className:"btn",href:"/",onClick:H((()=>u()))},F(U,{shape:Y}),"Export .zip archive..."),V({className:"btn"},F(U,{shape:"M16.7 10.2c-.3-.3-1.0-.3-1.4 0l-2.2 2.2v-7.5c0-.5-.4-1-1-1s-1 .4-1 1v7.5l-2.2-2.2c-.3-.3-1.0-.3-1.4 0s-.3 1.0 0 1.4l4.7 4.7 4.7-4.7c.3-.3.3-1.0 0-1.4z  M19 18c.55 0 1 .45 1 1s-.45 1-1 1h-14c-.55 0-1-.45-1-1s.45-1 1-1h14m0-2h-14c-1.6 0-3 1.3-3 3s1.3 3 3 3h14c1.6 0 3-1.3 3-3s-1.3-3-3-3z"}),"Import .zip archive...",W({type:"file",accept:"application/zip",onChange:H((async function(e){var n=e.target,r=n.files[0],i=r.name.replace(/\.zip$/,""),o=prompt("Specify folder name to import files into.\nLeave empty to load into root.",i);if(null!=o){o=o.trim()?o.replace(/\/$/,"")+"/":"";var a=await t.storage.files(),s=await l.default.loadAsync(r);for(var c in s.files)if(!c.split("/").some((e=>"."==e[0]))){var h=s.file(c);if(h){var d=await h.async("text"),u=f(o+c,a.map((e=>e.name))),v=new P(u);await v.insert(d)}}n.value="",t.finishedInsertingFiles()}}))})),G({className:"btn",href:"/",onClick:H((()=>e.app.saveAs()))},F(U,{shape:"M15 12h-2v-2c0-.5-.4-1-1-1s-1 .4-1 1v2h-2c-.5 0-1 .4-1 1s.4 1 1 1h2v2c0 .5.4 1 1 1s1-.4 1-1v-2h2c.5 0 1-.4 1-1s-.4-1-1-1zM19.7 7.2l-4-4c-.1-.1-.4-.2-.7-.2h-8c-1.6 0-3 1.3-3 3v12c0 1.6 1.3 3 3 3h10c1.6 0 3-1.3 3-3v-10c0-.2-.1-.52-.2-.7zm-2.1.7h-1.0c-.8 0-1.5-.6-1.5-1.5v-1.0l2.5 2.5zm-.5 11h-10c-.5 0-1-.4-1-1v-12c0-.5.4-1 1-1h7v1.5c0 1.3 1.1 2.5 2.5 2.5h1.5v9c0 .5-.4 1-1 1z"}),"Save to local file..."),q({},e.isLoaded?"Local files":"loading files..."),B({className:"file-entry "+(r?"active":"")},G({href:"#"},F(U,{shape:"M22.2 10.4c-3.39-2.8-9.5-8.1-9.6-8.2l-.6-.5-.6.5c-.0.0-6.2 5.3-9.66 8.2-.4.3-.6.9-.6 1.5 0 1.1.8 2 2 2h1v6c0 1.1.8 2 2 2h12c1.1 0 2-.8 2-2v-6h1c1.1 0 2-.8 2-2 0-.5-.2-1.1-.7-1.5zm-8.2 9.5h-4v-5h4v5zm4-8l.0 8h-3.0v-6h-6v6h-3v-8h-3.0c2.7-2.3 7.3-6.2 9.0-7.68 1.6 1.4 6.2 5.3 9 7.6l-3-.0z"}),"Home")),i.map((e=>e.isDir?function(e){return B({key:"//dir/"+e,className:"file-entry directory"},G({href:"javascript:void(0)"},F(U,{shape:"M18 6h-6c0-1.1-.8-2-2-2h-4c-1.6 0-3 1.3-3 3v10c0 1.6 1.3 3 3 3h12c1.6 0 3-1.3 3-3v-8c0-1.6-1.3-3-3-3zm-12 0h4c0 1.1.8 2 2 2h6c.5 0 1 .4 1 1h-14v-2c0-.5.4-1 1-1zm12 12h-12c-.5 0-1-.4-1-1v-7h14v7c0 .5-.4 1-1 1z"}),e),G({onClick:H((()=>u(e))),title:"Export folder as archive"},F(U,{shape:Y})))}(e.name):v(e.name,e.entry))),q({}," "),F("p",{},"Import files with ",F("code",{},"#import: file")),F("p",{},"Create folders with ",F("code",{},"/")," in filename"))}function ee(e){var t="url"==e.app.filesystem.storage.kind,n="local_file"==e.app.filesystem.storage.kind,r=H((()=>e.app.saveAs()));return t?B({className:"system-banners"},$({className:"banner card visible"},"View mode, changes are not saved.",G({onClick:r,href:"/",title:"Save this diagram to localStorage"},"save"),G({href:"#",title:"Discard this diagram"},"close"))):n?B({className:"system-banners"},$({className:"banner card visible"},'Editing "'+e.app.filesystem.activeFile.name+'"',G({href:"#",title:"Exit from this file"},"close"))):B({className:"system-banners"})}function te(e){var[t,r]=n.useState(null);function i(e){r(e?{title:"Compile error",details:e.message}:null)}return n.useEffect((()=>(e.app.signals.on("compile-error",i),()=>e.app.signals.off("compile-error",i)))),B({className:"terminal-banners"},t&&$({className:"banner card card-warning visible"},t.title,F("br"),F("tt",{},t.details)))}function ne(e){var[t,r]=n.useState(""),i=e.app;return B({className:"tools"},G({className:"logo",onClick:H((()=>i.toggleSidebar("about"))),onMouseLeave:()=>r(""),onMouseEnter:()=>r("About nomnoml")},((...e)=>F("h1",...e))({},"nomnoml ")),G({onClick:H((()=>i.toggleSidebar("about"))),onMouseLeave:()=>r(""),onMouseEnter:()=>r("About nomnoml")},F(U,{shape:"M14.2 16.0l.5-1.1c.8-1.61.8-3.2.2-4.5-.1-.2-.2-.4-.4-.6 1.4-.6 2.4-2.0 2.4-3.6 0-2.2-1.7-4-4-4s-4 1.7-4 4c0 .7.2 1.5.6 2.1-1.6.33-2.8 1.2-2.9 1.3-.7.6-.8 1.68-.4 2.5.3.5.8.9 1.4.98l-.5 1.1c-.8 1.61-.8 3.2-.2 4.5.5 1.1 1.6 1.9 2.9 2.2.4.0.8.1 1.2.1 2.3 0 3.9-1.3 4.14-1.5.7-.63.8-1.6.4-2.5-.3-.5-.8-.9-1.4-.98zm-1.2-12.0c1.1 0 2 .8 2 2s-.8 2-2 2c-1.1 0-2-.8-2-2s.8-2 2-2zm-1.8 14.9c-.2 0-.5-.0-.8-.0-1.6-.3-2.3-1.9-1.3-3.9l1-1.9c.5-.9.47-1.63-.1-2.0-.1-.1-.4-.1-.6-.1-.5 0-1.2.2-1.2.2s1.1-1.0 2.8-1.0c.2 0 .56.0.8.0 1.64.3 2.3 1.9 1.3 3.9l-1 1.9c-.5.9-.4 1.6.1 2.0.1.1.4.1.6.1.5 0 1.2-.2 1.2-.2s-1.1 1.0-2.8 1.0z"})),G({onClick:H((()=>i.toggleSidebar("reference"))),onMouseLeave:()=>r(""),onMouseEnter:()=>r("Language reference")},F(U,{shape:"M17 21h-10c-1.6 0-3-1.3-3-3v-12c0-1.6 1.3-3 3-3h10c1.6 0 3 1.3 3 3v12c0 1.6-1.3 3-3 3zm-10-16c-.5 0-1 .4-1 1v12c0 .5.4 1 1 1h10c.5 0 1-.4 1-1v-12c0-.5-.4-1-1-1h-10zM16 11h-8c-.2 0-.5-.2-.5-.5s.2-.5.5-.5h8c.2 0 .5.2.5.5s-.2.5-.5.5zM16 8h-8c-.2 0-.5-.2-.5-.5s.2-.5.5-.5h8c.2 0 .5.2.5.5s-.2.5-.5.5zM16 14h-8c-.2 0-.5-.2-.5-.5s.2-.5.5-.5h8c.2 0 .5.2.5.5s-.2.5-.5.5zM16 17h-8c-.2 0-.5-.2-.5-.5s.2-.5.5-.5h8c.2 0 .5.2.5.5s-.2.5-.5.5z"})),G({onClick:H((()=>i.toggleSidebar("export"))),onMouseLeave:()=>r(""),onMouseEnter:()=>r("Export this diagram")},F(U,{shape:"M12 21.3l-7.1-7.1c-1.17-1.17-1.17-3.0 0-4.2 1.0-1.0 2.9-1.1 4.1-.1v-4.8c0-1.6 1.3-3 3-3s3 1.3 3 3v4.8c1.1-1.0 3.0-.9 4.1.1 1.17 1.1 1.17 3.0 0 4.2l-7.1 7.1zm-5-10.2c-.2 0-.5.1-.7.2-.3.39-.3 1.0 0 1.4l5.7 5.7 5.7-5.7c.3-.3.3-1.0 0-1.4-.3-.3-1.0-.3-1.4 0l-3.2 3.2v-9.6c0-.5-.4-1-1-1s-1 .4-1 1v9.6l-3.2-3.2c-.1-.1-.4-.2-.7-.2z"})),G({onClick:H((()=>i.toggleSidebar("files"))),onMouseLeave:()=>r(""),onMouseEnter:()=>r("Save this or load another diagram")},F(U,{shape:"M22.3 8h-2.4c-.4-1.2-1.5-2-2.8-2h-6c0-1.1-.9-2-2-2h-4.1c-1.7 0-3 1.3-3 3v10c0 1.7 1.3 3 3 3h12c1.7 0 3.4-1.3 3.8-3l2.2-8c.1-.6-.2-1-.7-1zm-18.3 1v-2c0-.6.4-1 1-1h4c0 1.1.9 2 2 2h6c.6 0 1 .4 1 1h-11.1c-.6 0-1.1.4-1.3 1l-1.6 6.3v-7.3zm14.9 7.5c-.2.8-1.1 1.5-1.9 1.5h-12s-.4-.2-.2-.8l1.9-7c0-.1.2-.2.3-.2h13.7l-1.8 6.5z"})),i.dynamicButton?i.dynamicButton(i,r):G({onClick:H((()=>i.discardCurrentGraph())),onMouseLeave:()=>r(""),onMouseEnter:()=>r("Discard current diagram")},F(U,{shape:J})),B({id:"tooltip"},t),F(ee,{app:i}),F(te,{app:i}))}e.app=void 0,e.App=D,e.DailyTip=function(e){var t="hide"!=localStorage[e.id],[,r]=n.useState(!0);return B({className:"alert card "+(t?"":"alert-hidden")},e.children,G({className:"alert-close",onClick:H((function(){localStorage[e.id]="hide",r(!1)}))},"×"))},e.NomnomlGraph=function(e){return $({dangerouslySetInnerHTML:{__html:_.exports.renderSvg(e.source)}})},e.bootstrap=function(t){e.app=new D(t);var n=e=>document.querySelector(e);function r(){s.render(F(X,{app:e.app}),n("[export-menu]")),s.render(F(ne,{app:e.app}),n("[menu]")),s.render(F(Q,{app:e.app}),n("[canvas-tools]"))}function i(){s.render(F(Z,{app:e.app,files:[],isLoaded:!1}),n("[file-menu]")),e.app.filesystem.storage.files().then((t=>{s.render(F(Z,{app:e.app,files:t,isLoaded:!0}),n("[file-menu]"))}))}r(),i(),e.app.signals.on("source-changed",r),e.app.signals.on("compile-error",r),e.app.filesystem.signals.on("updated",i),function(){for(var e={},t=document.querySelectorAll("[publish-as-file]"),n=0;n<t.length;n++){var r=t[n].attributes.getNamedItem("publish-as-file")?.value;e[r]=c(t[n].innerHTML)}var i=document.querySelectorAll("[append-nomnoml-preview]");for(n=0;n<i.length;n++)try{var o=i[n],a=_.exports.processImports(c(o.innerHTML),(t=>e[t])),s=_.exports.renderSvg(a,document),l=document.createElement("div");l.innerHTML=s,o.append(l)}catch(e){}}()},e.nomnoml=N,e.version="1.5.3+master.336335d2",Object.defineProperty(e,"__esModule",{value:!0})}));
